module.exports=[57012,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(71987),f=a.i(38246),g=a.i(19032),h=a.i(6704),i=a.i(27348),j=a.i(95245),k=a.i(59501),l=a.i(56757);let m=l.z.object({comment:l.z.string().max(500,"Comment cannot exceed 500 characters").optional()});var n=a.i(32636);function o(){let a=(0,d.useParams)(),l=(0,d.useRouter)(),{user:o}=(0,n.useAuth)(),p=a.id,[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(1),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(0),[M,N]=(0,c.useState)(0),{register:O,handleSubmit:P,formState:{errors:Q},reset:R}=(0,j.useForm)({resolver:(0,k.zodResolver)(m)});(0,c.useEffect)(()=>{p&&S()},[p]);let S=async()=>{t(!0);try{let a=await g.default.get(`/products/${p}`),b=a.data.product||a.data;r(b),z(b.image||"")}catch(a){h.default.error(a.response?.data?.message||"Failed to load product"),l.push("/menu")}finally{t(!1)}},T=async()=>{if(q){x(!0);try{await g.default.post("/cart/add",{productId:q._id,quantity:u}),h.default.success(`${q.name} added to cart!`)}catch(a){h.default.error(a.response?.data?.message||"Failed to add to cart")}finally{x(!1)}}};(0,c.useEffect)(()=>{!a.id||((async()=>{try{let b=await g.default.get(`/reviews/product/${a.id}`);if(B(b.data.reviews||[]),o){let a=(b.data.reviews||[]).find(a=>("object"==typeof a.user?a.user._id:a.user)===o._id);a&&F(a)}}catch{}D(!1)})(),o&&g.default.get("/orders/my-orders").then(b=>{H((b.data.orders||[]).some(b=>["completed","served"].includes(b.status)&&b.items.some(b=>b.product===a.id)))}).catch(()=>{}))},[a.id,o]);let U=async b=>{if(0===K)return void h.default.error("Please select a rating");try{J(!0);let c=await g.default.post(`/reviews/product/${a.id}`,{rating:K,comment:b.comment||""});B(a=>[c.data.review,...a]),F(c.data.review),R(),L(0),h.default.success("Review submitted!");let d=await g.default.get(`/products/${a.id}`);r(d.data.product)}catch(a){h.default.error(a.response?.data?.message||"Failed to submit review")}finally{J(!1)}},V=()=>q&&"object"==typeof q.category&&null!==q.category?q.category.name:"",W=q?[q.image,...q.images||[]].filter(Boolean):[];return s?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-6 w-32 rounded bg-gray-200 animate-pulse"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,b.jsx)("div",{className:"h-96 rounded-xl bg-gray-200 animate-pulse"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"h-8 w-3/4 rounded bg-gray-200 animate-pulse"}),(0,b.jsx)("div",{className:"h-4 w-1/4 rounded bg-gray-200 animate-pulse"}),(0,b.jsx)("div",{className:"h-20 w-full rounded bg-gray-200 animate-pulse"}),(0,b.jsx)("div",{className:"h-10 w-32 rounded bg-gray-200 animate-pulse"}),(0,b.jsx)("div",{className:"h-12 w-48 rounded bg-gray-200 animate-pulse"})]})]})]}):q?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(f.default,{href:"/menu",className:"inline-flex items-center gap-2 text-sm font-medium text-gray-500 transition-colors hover:text-[#c47a5a]",children:[(0,b.jsx)(i.FiArrowLeft,{className:"h-4 w-4"}),"Back to Menu"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"relative h-80 w-full overflow-hidden rounded-xl bg-gray-100 sm:h-96",children:[(0,b.jsx)(e.default,{src:(0,g.getImageUrl)(y),alt:q.name,width:800,height:600,unoptimized:!0,className:"h-full w-full object-cover"}),(0,b.jsx)("span",{className:`absolute left-3 top-3 inline-flex h-6 w-6 items-center justify-center rounded-sm border-2 bg-white ${q.isVeg?"border-green-500":"border-red-500"}`,children:(0,b.jsx)("span",{className:`h-2.5 w-2.5 rounded-full ${q.isVeg?"bg-green-500":"bg-red-500"}`})}),!q.isAvailable&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,b.jsx)("span",{className:"rounded-full bg-white px-4 py-2 text-sm font-semibold text-gray-700",children:"Currently Unavailable"})})]}),W.length>1&&(0,b.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:W.map((a,c)=>(0,b.jsx)("button",{onClick:()=>z(a),className:`shrink-0 h-16 w-16 overflow-hidden rounded-lg border-2 transition-colors ${y===a?"border-[#c47a5a]":"border-transparent hover:border-gray-300"}`,children:(0,b.jsx)(e.default,{src:(0,g.getImageUrl)(a),alt:`${q.name} ${c+1}`,width:64,height:64,unoptimized:!0,className:"h-full w-full object-cover"})},c))})]}),(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 sm:text-3xl",children:q.name}),V()&&(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-400",children:V()})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:5}).map((a,c)=>(0,b.jsx)(i.FiStar,{className:`h-5 w-5 ${c<Math.round(q.rating)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},c))}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-600",children:q.rating.toFixed(1)}),(0,b.jsxs)("span",{className:"text-sm text-gray-400",children:["(",q.numReviews," review",1!==q.numReviews?"s":"",")"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-sm border-2 ${q.isVeg?"border-green-500":"border-red-500"}`,children:(0,b.jsx)("span",{className:`h-2 w-2 rounded-full ${q.isVeg?"bg-green-500":"bg-red-500"}`})}),(0,b.jsx)("span",{className:`text-sm font-medium ${q.isVeg?"text-green-600":"text-red-600"}`,children:q.isVeg?"Vegetarian":"Non-Vegetarian"})]}),(0,b.jsxs)("p",{className:"text-3xl font-bold text-gray-800",children:["â‚¹",q.price.toFixed(2)]}),q.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-700",children:"Description"}),(0,b.jsx)("p",{className:"mt-1 text-sm leading-relaxed text-gray-500",children:q.description})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Quantity:"}),(0,b.jsxs)("div",{className:"flex items-center rounded-lg border border-gray-200",children:[(0,b.jsx)("button",{onClick:()=>v(a=>Math.max(1,a-1)),disabled:u<=1,className:"flex h-10 w-10 items-center justify-center text-gray-600 transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-40",children:(0,b.jsx)(i.FiMinus,{className:"h-4 w-4"})}),(0,b.jsx)("span",{className:"flex h-10 w-12 items-center justify-center border-x border-gray-200 text-sm font-semibold text-gray-800",children:u}),(0,b.jsx)("button",{onClick:()=>v(a=>Math.min(20,a+1)),disabled:u>=20,className:"flex h-10 w-10 items-center justify-center text-gray-600 transition-colors hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-40",children:(0,b.jsx)(i.FiPlus,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("button",{onClick:T,disabled:!q.isAvailable||w,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3.5 text-base font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50 sm:w-auto",children:[w?(0,b.jsx)("span",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,b.jsx)(i.FiShoppingCart,{className:"h-5 w-5"}),w?"Adding...":q.isAvailable?"Add to Cart":"Unavailable"]})]})]}),(0,b.jsxs)("div",{className:"mt-8 bg-white rounded-xl shadow-sm p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-6",children:"Reviews & Ratings"}),o&&G&&!E&&(0,b.jsxs)("div",{className:"mb-8 border border-gray-100 rounded-lg p-5 bg-gray-50",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Write a Review"}),(0,b.jsxs)("form",{onSubmit:P(U),children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 mb-3",children:[[1,2,3,4,5].map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>L(a),onMouseEnter:()=>N(a),onMouseLeave:()=>N(0),className:"focus:outline-none",children:(0,b.jsx)(i.FiStar,{size:24,className:`transition-colors ${a<=(M||K)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},a)),K>0&&(0,b.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:[K,"/5"]})]}),(0,b.jsx)("textarea",{...O("comment"),placeholder:"Share your experience (optional)",rows:3,className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[var(--primary)]/20 focus:border-[var(--primary)] resize-none text-sm"}),Q.comment&&(0,b.jsx)("p",{className:"text-red-500 text-xs mt-1",children:Q.comment.message}),(0,b.jsxs)("button",{type:"submit",disabled:I||0===K,className:"mt-3 flex items-center gap-2 px-5 py-2 bg-[var(--primary)] text-white rounded-lg text-sm font-medium hover:opacity-90 disabled:opacity-50 transition-opacity",children:[(0,b.jsx)(i.FiSend,{size:14}),I?"Submitting...":"Submit Review"]})]})]}),E&&(0,b.jsxs)("div",{className:"mb-6 border border-[var(--primary)]/20 rounded-lg p-4 bg-[var(--primary)]/5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-[var(--primary)]",children:"Your Review"}),(0,b.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(a=>(0,b.jsx)(i.FiStar,{size:14,className:a<=E.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"},a))})]}),E.comment&&(0,b.jsx)("p",{className:"text-sm text-gray-600",children:E.comment})]}),C?(0,b.jsx)("div",{className:"space-y-4",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"animate-pulse flex gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]},a))}):0===A.length?(0,b.jsx)("p",{className:"text-gray-400 text-sm text-center py-8",children:"No reviews yet. Be the first to review!"}):(0,b.jsx)("div",{className:"space-y-4",children:A.map(a=>{let c="object"==typeof a.user?a.user:null;return(0,b.jsxs)("div",{className:"flex gap-3 pb-4 border-b border-gray-100 last:border-0",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0",children:c?.avatar?(0,b.jsx)(e.default,{src:(0,g.getImageUrl)(c.avatar),alt:"",width:40,height:40,className:"w-full h-full rounded-full object-cover",unoptimized:!0}):(0,b.jsx)(i.FiUser,{size:16,className:"text-gray-400"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:c?.name||"User"}),(0,b.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(c=>(0,b.jsx)(i.FiStar,{size:12,className:c<=a.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"},c))}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:new Date(a.createdAt).toLocaleDateString()})]}),a.comment&&(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.comment})]})]},a._id)})})]})]}):(0,b.jsxs)("div",{className:"py-20 text-center",children:[(0,b.jsx)("p",{className:"text-lg text-gray-500",children:"Product not found."}),(0,b.jsxs)(f.default,{href:"/menu",className:"mt-4 inline-flex items-center gap-2 text-[#c47a5a] hover:underline",children:[(0,b.jsx)(i.FiArrowLeft,{className:"h-4 w-4"}),"Back to Menu"]})]})}a.s(["default",()=>o],57012)}];

//# sourceMappingURL=src_app_%28dashboard%29_%28customer%29_menu_%5Bid%5D_page_tsx_75acc918._.js.map