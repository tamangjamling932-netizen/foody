{"version":3,"sources":["../../../../src/lib/currency.ts","../../../../src/app/%28dashboard%29/%28customer%29/dashboard/page.tsx"],"sourcesContent":["// Nepali Rupee currency formatter\nexport const CURRENCY_SYMBOL = \"â‚¨\"; // Nepali Rupee Symbol\nexport const CURRENCY_CODE = \"NPR\";\n\nexport function formatCurrency(amount: number): string {\n  return `${CURRENCY_SYMBOL} ${amount.toFixed(2)}`;\n}\n\nexport function formatCurrencyCompact(amount: number): string {\n  return `${CURRENCY_SYMBOL}${amount.toFixed(2)}`;\n}\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport API from \"@/lib/api\";\nimport { Order, Product } from \"@/types\";\nimport toast from \"react-hot-toast\";\nimport {\n  FiShoppingBag,\n  FiClock,\n  FiDollarSign,\n  FiArrowRight,\n  FiShoppingCart,\n  FiList,\n  FiPackage,\n  FiTrendingUp,\n  FiStar,\n} from \"react-icons/fi\";\nimport { formatCurrency } from \"@/lib/currency\";\n\nexport default function CustomerDashboard() {\n  const { user } = useAuth();\n  const router = useRouter();\n  const [orders, setOrders] = useState<Order[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchOrders();\n  }, []);\n\n  const fetchOrders = async () => {\n    try {\n      const res = await API.get(\"/orders/my-orders\");\n      setOrders(res.data.orders || res.data);\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Failed to load orders\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const totalOrders = orders.length;\n  const pendingOrders = orders.filter(\n    (o) => o.status === \"pending\" || o.status === \"confirmed\" || o.status === \"preparing\"\n  ).length;\n  const totalSpent = orders\n    .filter((o) => o.status !== \"cancelled\")\n    .reduce((sum, o) => sum + o.total, 0);\n\n  // Calculate most ordered items\n  const itemFrequency: { [key: string]: { name: string; count: number; image: string } } = {};\n  orders.forEach((order) => {\n    order.items.forEach((item) => {\n      if (itemFrequency[item.product]) {\n        itemFrequency[item.product].count += item.quantity;\n      } else {\n        itemFrequency[item.product] = {\n          name: item.name,\n          count: item.quantity,\n          image: item.image,\n        };\n      }\n    });\n  });\n\n  const mostOrderedItems = Object.values(itemFrequency)\n    .sort((a, b) => b.count - a.count)\n    .slice(0, 3);\n\n  const recentOrders = orders.slice(0, 5);\n\n  const statusColor = (status: Order[\"status\"]) => {\n    switch (status) {\n      case \"pending\":\n        return \"bg-yellow-100 text-yellow-800\";\n      case \"confirmed\":\n        return \"bg-blue-100 text-blue-800\";\n      case \"preparing\":\n        return \"bg-orange-100 text-orange-800\";\n      case \"served\":\n        return \"bg-purple-100 text-purple-800\";\n      case \"completed\":\n        return \"bg-green-100 text-green-800\";\n      case \"cancelled\":\n        return \"bg-red-100 text-red-800\";\n      default:\n        return \"bg-gray-100 text-gray-800\";\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"h-10 w-10 animate-spin rounded-full border-4 border-[#c47a5a] border-t-transparent\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Welcome Section */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-gray-800\">\n          Welcome back, {user?.name?.split(\" \")[0] || \"Guest\"}!\n        </h1>\n        <p className=\"mt-1 text-gray-500\">\n          Here&apos;s a summary of your orders and activity.\n        </p>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-3\">\n        <div className=\"flex items-center gap-4 rounded-xl bg-white p-5 shadow-sm\">\n          <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-[#c47a5a]/10\">\n            <FiShoppingBag className=\"h-6 w-6 text-[#c47a5a]\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">Total Orders</p>\n            <p className=\"text-2xl font-bold text-gray-800\">{totalOrders}</p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-4 rounded-xl bg-white p-5 shadow-sm\">\n          <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-yellow-100\">\n            <FiClock className=\"h-6 w-6 text-yellow-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">Pending Orders</p>\n            <p className=\"text-2xl font-bold text-gray-800\">{pendingOrders}</p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-4 rounded-xl bg-white p-5 shadow-sm\">\n          <div className=\"flex h-12 w-12 items-center justify-center rounded-lg bg-green-100\">\n            <FiDollarSign className=\"h-6 w-6 text-green-600\" />\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">Total Spent</p>\n            <p className=\"text-2xl font-bold text-gray-800\">\n              {formatCurrency(totalSpent)}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Most Ordered Items */}\n      {mostOrderedItems.length > 0 && (\n        <div className=\"rounded-xl bg-white p-5 shadow-sm\">\n          <h2 className=\"mb-4 flex items-center gap-2 text-lg font-semibold text-gray-800\">\n            <FiTrendingUp className=\"h-5 w-5 text-[#c47a5a]\" />\n            Your Favorite Items\n          </h2>\n          <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-3\">\n            {mostOrderedItems.map((item, idx) => (\n              <div key={idx} className=\"flex items-center gap-3 rounded-lg bg-gradient-to-r from-[#c47a5a]/5 to-transparent p-4\">\n                <div className=\"flex-shrink-0\">\n                  <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-[#c47a5a]/10 text-sm font-bold text-[#c47a5a]\">\n                    #{idx + 1}\n                  </div>\n                </div>\n                <div className=\"flex-1 min-w-0\">\n                  <p className=\"text-sm font-medium text-gray-800 truncate\">{item.name}</p>\n                  <p className=\"text-xs text-gray-500\">Ordered {item.count}x</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Quick Actions */}\n      <div className=\"grid grid-cols-1 gap-3 sm:grid-cols-3\">\n        <button\n          onClick={() => router.push(\"/menu\")}\n          className=\"flex items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-5 py-3 font-medium text-white transition-colors hover:bg-[#b56a4a]\"\n        >\n          <FiPackage className=\"h-5 w-5\" />\n          Browse Menu\n        </button>\n        <button\n          onClick={() => router.push(\"/cart\")}\n          className=\"flex items-center justify-center gap-2 rounded-xl border-2 border-[#c47a5a] px-5 py-3 font-medium text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5\"\n        >\n          <FiShoppingCart className=\"h-5 w-5\" />\n          View Cart\n        </button>\n        <button\n          onClick={() => router.push(\"/orders\")}\n          className=\"flex items-center justify-center gap-2 rounded-xl border-2 border-[#c47a5a] px-5 py-3 font-medium text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5\"\n        >\n          <FiList className=\"h-5 w-5\" />\n          View Orders\n        </button>\n      </div>\n\n      {/* Recent Orders */}\n      <div className=\"rounded-xl bg-white p-5 shadow-sm\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-lg font-semibold text-gray-800\">Recent Orders</h2>\n          {orders.length > 5 && (\n            <button\n              onClick={() => router.push(\"/orders\")}\n              className=\"flex items-center gap-1 text-sm font-medium text-[#c47a5a] hover:underline\"\n            >\n              View All <FiArrowRight className=\"h-4 w-4\" />\n            </button>\n          )}\n        </div>\n\n        {recentOrders.length === 0 ? (\n          <div className=\"py-10 text-center text-gray-400\">\n            <FiShoppingBag className=\"mx-auto mb-2 h-10 w-10\" />\n            <p>No orders yet. Start by browsing the menu!</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-left text-sm\">\n              <thead>\n                <tr className=\"border-b text-gray-500\">\n                  <th className=\"pb-3 font-medium\">Order ID</th>\n                  <th className=\"pb-3 font-medium\">Items</th>\n                  <th className=\"pb-3 font-medium\">Total</th>\n                  <th className=\"pb-3 font-medium\">Status</th>\n                  <th className=\"pb-3 font-medium\">Date</th>\n                </tr>\n              </thead>\n              <tbody>\n                {recentOrders.map((order) => (\n                  <tr\n                    key={order._id}\n                    className=\"border-b last:border-0 hover:bg-gray-50 cursor-pointer\"\n                    onClick={() => router.push(`/orders/${order._id}`)}\n                  >\n                    <td className=\"py-3 font-mono text-xs text-gray-600\">\n                      #{order._id.slice(-6).toUpperCase()}\n                    </td>\n                    <td className=\"py-3 text-gray-700\">\n                      {order.items.length} item{order.items.length !== 1 && \"s\"}\n                    </td>\n                    <td className=\"py-3 font-medium text-gray-800\">\n                      {formatCurrency(order.total)}\n                    </td>\n                    <td className=\"py-3\">\n                      <span\n                        className={`inline-block rounded-full px-2.5 py-0.5 text-xs font-medium capitalize ${statusColor(order.status)}`}\n                      >\n                        {order.status}\n                      </span>\n                    </td>\n                    <td className=\"py-3 text-gray-500\">\n                      {new Date(order.createdAt).toLocaleDateString()}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}