module.exports=[80075,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(71987),f=a.i(38246),g=a.i(19032),h=a.i(6704),i=a.i(27348),j=a.i(53696);let k={pending:{bg:"bg-yellow-50",text:"text-yellow-700",dot:"bg-yellow-500"},confirmed:{bg:"bg-blue-50",text:"text-blue-700",dot:"bg-blue-500"},preparing:{bg:"bg-orange-50",text:"text-orange-700",dot:"bg-orange-500"},served:{bg:"bg-purple-50",text:"text-purple-700",dot:"bg-purple-500"},completed:{bg:"bg-green-50",text:"text-green-700",dot:"bg-green-500"},cancelled:{bg:"bg-red-50",text:"text-red-700",dot:"bg-red-500"}},l=[{value:"cash",label:"Cash"},{value:"esewa",label:"eSewa"},{value:"khalti",label:"Khalti"},{value:"bank",label:"Bank Transfer"}];function m(){let a=(0,d.useParams)().id,[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)("cash");(0,c.useEffect)(()=>{a&&y()},[a]);let y=async()=>{r(!0);try{let b=await g.default.get(`/orders/${a}`),c=b.data.order||b.data;n(c),await z()}catch(a){h.default.error(a.response?.data?.message||"Failed to load order")}finally{r(!1)}},z=async()=>{try{let b=await g.default.get(`/bills?order=${a}`),c=b.data.bills||b.data||[];Array.isArray(c)&&c.length>0?p(c[0]):b.data.bill&&p(b.data.bill)}catch{}},A=async(b={})=>{t(!0);try{let c=await g.default.post(`/bills/${a}/request`,{callWaiter:b.callWaiter||!1}),d=c.data.bill||c.data;p(d),h.default.success(b.callWaiter?"Waiter has been called for your bill!":"Bill requested successfully!")}catch(a){h.default.error(a.response?.data?.message||"Failed to request bill")}finally{t(!1)}},B=()=>{if(!o)return;let a=`http://localhost:5000/api/bills/${o._id}/pdf`;window.open(`${a}?token=null`,"_blank")},C=async()=>{if(o){v(!0);try{let b=await g.default.put(`/bills/${o._id}/pay`,{paymentMethod:w}),c=b.data.bill||b.data;p(c);let d=await g.default.get(`/orders/${a}`);n(d.data.order||d.data),h.default.success("Payment successful!")}catch(a){h.default.error(a.response?.data?.message||"Payment failed")}finally{v(!1)}}},D=a=>new Date(a).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),E=m&&("completed"===m.status||"served"===m.status);if(q)return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-5 w-32 rounded bg-gray-200 animate-pulse"}),(0,b.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm animate-pulse",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"h-6 w-48 rounded bg-gray-200"}),(0,b.jsx)("div",{className:"h-4 w-64 rounded bg-gray-200"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"h-6 w-20 rounded-full bg-gray-200"}),(0,b.jsx)("div",{className:"h-6 w-20 rounded-full bg-gray-200"})]})]})}),(0,b.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm animate-pulse",children:[(0,b.jsx)("div",{className:"h-5 w-24 rounded bg-gray-200 mb-4"}),Array.from({length:3}).map((a,c)=>(0,b.jsxs)("div",{className:"flex gap-4 py-4 border-b border-gray-50 last:border-0",children:[(0,b.jsx)("div",{className:"h-16 w-16 shrink-0 rounded-lg bg-gray-200"}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("div",{className:"h-4 w-3/4 rounded bg-gray-200"}),(0,b.jsx)("div",{className:"h-3 w-1/4 rounded bg-gray-200"})]}),(0,b.jsx)("div",{className:"h-4 w-16 rounded bg-gray-200"})]},c))]}),(0,b.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm animate-pulse",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"h-4 w-full rounded bg-gray-200"}),(0,b.jsx)("div",{className:"h-4 w-full rounded bg-gray-200"}),(0,b.jsx)("div",{className:"h-5 w-full rounded bg-gray-200"})]})})]});if(!m)return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(f.default,{href:"/orders",className:"inline-flex items-center gap-2 text-sm font-medium text-[#c47a5a] transition-colors hover:underline",children:[(0,b.jsx)(i.FiArrowLeft,{className:"h-4 w-4"}),"Back to Orders"]}),(0,b.jsxs)("div",{className:"rounded-xl bg-white py-20 text-center shadow-sm",children:[(0,b.jsx)(i.FiPackage,{className:"mx-auto mb-4 h-16 w-16 text-gray-300"}),(0,b.jsx)("p",{className:"text-lg font-medium text-gray-500",children:"Order not found"})]})]});let F=k[m.status];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(f.default,{href:"/orders",className:"inline-flex items-center gap-2 text-sm font-medium text-[#c47a5a] transition-colors hover:underline",children:[(0,b.jsx)(i.FiArrowLeft,{className:"h-4 w-4"}),"Back to Orders"]}),(0,b.jsx)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("h1",{className:"text-xl font-bold text-gray-800",children:["Order #",m._id.slice(-6).toUpperCase()]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(i.FiClock,{className:"h-4 w-4"}),D(m.createdAt)]}),m.tableNumber&&(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(i.FiPackage,{className:"h-4 w-4"}),"Table ",m.tableNumber]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsxs)("span",{className:`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-sm font-medium ${F.bg} ${F.text}`,children:[(0,b.jsx)("span",{className:`h-2 w-2 rounded-full ${F.dot}`}),m.status.charAt(0).toUpperCase()+m.status.slice(1)]}),(0,b.jsxs)("span",{className:`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-sm font-medium ${m.isPaid?"bg-green-50 text-green-700":"bg-gray-100 text-gray-500"}`,children:[m.isPaid?(0,b.jsx)(i.FiCheckCircle,{className:"h-3.5 w-3.5"}):(0,b.jsx)(i.FiXCircle,{className:"h-3.5 w-3.5"}),m.isPaid?"Paid":"Unpaid"]})]})]})}),(0,b.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,b.jsxs)("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:["Items (",m.items.length,")"]}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:m.items.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-4 py-4 first:pt-0 last:pb-0",children:[(0,b.jsx)(e.default,{src:(0,g.getImageUrl)(a.image),alt:a.name,width:64,height:64,unoptimized:!0,className:"h-16 w-16 shrink-0 rounded-lg object-cover"}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:a.name}),(0,b.jsxs)("p",{className:"mt-0.5 text-xs text-gray-500",children:["₹",a.price.toFixed(2)," x ",a.quantity]})]}),(0,b.jsxs)("span",{className:"shrink-0 text-sm font-semibold text-gray-800",children:["₹",(a.price*a.quantity).toFixed(2)]})]},c))})]}),m.notes&&(0,b.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,b.jsx)("h2",{className:"mb-2 text-lg font-semibold text-gray-800",children:"Notes"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:m.notes})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,b.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Order Summary"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Subtotal"}),(0,b.jsx)("span",{className:"font-medium text-gray-700",children:(0,j.formatCurrency)(m.subtotal)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Tax"}),(0,b.jsx)("span",{className:"font-medium text-gray-700",children:(0,j.formatCurrency)(m.tax)})]}),(0,b.jsx)("div",{className:"border-t border-gray-100 pt-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-base font-semibold text-gray-800",children:"Total"}),(0,b.jsx)("span",{className:"text-xl font-bold text-gray-800",children:(0,j.formatCurrency)(m.total)})]})})]})]}),E&&(0,b.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm",children:[(0,b.jsx)("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Billing"}),o?"requested"===o.status?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-yellow-50 border border-yellow-200 p-3",children:[(0,b.jsx)(i.FiClock,{className:"h-5 w-5 text-yellow-600"}),(0,b.jsx)("span",{className:"font-semibold text-yellow-700",children:"Waiting for staff confirmation..."})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Bill Number"}),(0,b.jsx)("span",{className:"font-medium text-gray-700",children:o.billNumber})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Amount"}),(0,b.jsx)("span",{className:"font-semibold text-gray-800",children:(0,j.formatCurrency)(o.total)})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Payment Method"}),(0,b.jsx)("span",{className:"font-medium capitalize text-gray-700",children:o.paymentMethod})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Payment Status"}),(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-sm font-medium text-gray-500",children:[(0,b.jsx)(i.FiXCircle,{className:"h-3.5 w-3.5"}),"Unpaid"]})]})]}),(0,b.jsxs)("button",{onClick:B,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5",children:[(0,b.jsx)(i.FiDownload,{className:"h-5 w-5"}),"Download PDF"]}),(0,b.jsxs)("div",{className:"space-y-3 border-t border-gray-100 pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-800",children:"Pay Bill"}),(0,b.jsx)("div",{className:"flex gap-2",children:l.map(a=>(0,b.jsx)("button",{onClick:()=>x(a.value),className:`flex-1 rounded-lg border px-3 py-2 text-sm font-medium transition-colors ${w===a.value?"border-[#c47a5a] bg-[#c47a5a]/5 text-[#c47a5a]":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:a.label},a.value))}),(0,b.jsxs)("button",{onClick:C,disabled:u,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3 font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50",children:[u?(0,b.jsx)("span",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,b.jsx)(i.FiCreditCard,{className:"h-5 w-5"}),u?"Processing Payment...":"Pay Bill"]})]})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[o.isPaid&&(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 rounded-lg bg-green-50 border border-green-200 p-3",children:[(0,b.jsx)(i.FiCheckCircle,{className:"h-5 w-5 text-green-600"}),(0,b.jsx)("span",{className:"font-semibold text-green-700",children:"Paid"}),o.paymentMethod&&(0,b.jsxs)("span",{className:"text-sm text-green-600",children:["via ",(0,b.jsx)("span",{className:"capitalize",children:o.paymentMethod})]})]}),(0,b.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Bill Number"}),(0,b.jsx)("span",{className:"font-medium text-gray-700",children:o.billNumber})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Amount"}),(0,b.jsx)("span",{className:"font-semibold text-gray-800",children:(0,j.formatCurrency)(o.total)})]}),o.paymentMethod&&(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Payment Method"}),(0,b.jsx)("span",{className:"font-medium capitalize text-gray-700",children:o.paymentMethod})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Payment Status"}),(0,b.jsxs)("span",{className:`inline-flex items-center gap-1 text-sm font-medium ${o.isPaid?"text-green-600":"text-gray-500"}`,children:[o.isPaid?(0,b.jsx)(i.FiCheckCircle,{className:"h-3.5 w-3.5"}):(0,b.jsx)(i.FiXCircle,{className:"h-3.5 w-3.5"}),o.isPaid?"Paid":"Unpaid"]})]}),o.isPaid&&o.paidAt&&(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Paid At"}),(0,b.jsx)("span",{className:"font-medium text-gray-700",children:D(o.paidAt)})]})]}),(0,b.jsxs)("button",{onClick:B,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5",children:[(0,b.jsx)(i.FiDownload,{className:"h-5 w-5"}),"Download PDF"]}),!o.isPaid&&(0,b.jsxs)("div",{className:"space-y-3 border-t border-gray-100 pt-4",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-800",children:"Pay Bill"}),(0,b.jsx)("div",{className:"flex gap-2",children:l.map(a=>(0,b.jsx)("button",{onClick:()=>x(a.value),className:`flex-1 rounded-lg border px-3 py-2 text-sm font-medium transition-colors ${w===a.value?"border-[#c47a5a] bg-[#c47a5a]/5 text-[#c47a5a]":"border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:a.label},a.value))}),(0,b.jsxs)("button",{onClick:C,disabled:u,className:"flex w-full items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3 font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50",children:[u?(0,b.jsx)("span",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,b.jsx)(i.FiCreditCard,{className:"h-5 w-5"}),u?"Processing Payment...":"Pay Bill"]})]})]}):(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,b.jsxs)("button",{onClick:()=>A(),disabled:s,className:"flex flex-1 items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3 font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50",children:[s?(0,b.jsx)("span",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):(0,b.jsx)(i.FiFileText,{className:"h-5 w-5"}),s?"Requesting...":"Request Bill"]}),(0,b.jsxs)("button",{onClick:()=>A({callWaiter:!0}),disabled:s,className:"flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,b.jsx)(i.FiClock,{className:"h-5 w-5"}),"Call Waiter for Bill"]})]})]})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=src_app_%28dashboard%29_%28customer%29_orders_%5Bid%5D_page_tsx_48994f74._.js.map