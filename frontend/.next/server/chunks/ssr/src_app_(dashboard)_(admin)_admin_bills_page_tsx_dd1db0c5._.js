module.exports=[51016,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(19032),e=a.i(32636),f=a.i(6704),g=a.i(27348);let h=["cash","esewa","khalti","bank"];function i(){let{user:a}=(0,e.useAuth)(),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)({page:1,limit:10,total:0,pages:1}),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)({}),[u,v]=(0,c.useState)(null);(0,c.useEffect)(()=>{w()},[k.page,o]);let w=async()=>{n(!0);try{let a={page:k.page,limit:k.limit};"paid"===o&&(a.isPaid="true"),"unpaid"===o&&(a.isPaid="false");let b=await d.default.get("/bills",{params:a});j(b.data.bills||b.data.data||[]),b.data.pagination&&l(b.data.pagination)}catch{f.default.error("Failed to load bills")}finally{n(!1)}},x=async a=>{let b=s[a]||"cash";r(a);try{await d.default.put(`/bills/${a}/pay`,{paymentMethod:b}),j(c=>c.map(c=>c._id===a?{...c,isPaid:!0,paymentMethod:b,paidAt:new Date().toISOString()}:c)),f.default.success("Bill marked as paid")}catch(a){f.default.error(a.response?.data?.message||"Failed to mark bill as paid")}finally{r(null)}},y=async a=>{v(a);try{let b=localStorage.getItem("token"),c=await fetch(`${d.default.defaults.baseURL}/bills/${a}/pdf`,{headers:{Authorization:`Bearer ${b}`}});if(!c.ok)throw Error("Failed to download PDF");let e=await c.blob(),g=URL.createObjectURL(e),h=document.createElement("a");h.href=g,h.download=`bill-${a}.pdf`,h.click(),URL.revokeObjectURL(g),f.default.success("PDF downloaded")}catch(a){f.default.error("Failed to download PDF")}finally{v(null)}},z=a=>{switch(a){case"esewa":return"eSewa";case"khalti":return"Khalti";case"bank":return"Bank Transfer";case"cash":return"Cash";default:return a}};return m&&0===i.length?(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-[#c47a5a] border-t-transparent"})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Bills"}),(0,b.jsx)("p",{className:"mt-1 text-gray-500",children:"View and manage billing records"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:[{label:"All",value:""},{label:"Paid",value:"paid"},{label:"Unpaid",value:"unpaid"}].map(a=>(0,b.jsx)("button",{onClick:()=>{p(a.value),l(a=>({...a,page:1}))},className:`rounded-lg px-4 py-2 text-sm font-medium transition-colors ${o===a.value?"bg-[#c47a5a] text-white":"bg-white text-gray-600 shadow-sm hover:bg-gray-50"}`,children:a.label},a.value))}),(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl bg-white shadow-sm",children:(0,b.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Bill #"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Order"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Customer"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Total"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Payment"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Status"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Date"}),(0,b.jsx)("th",{className:"px-4 py-3 font-medium text-gray-500",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:0===i.length?(0,b.jsx)("tr",{children:(0,b.jsxs)("td",{colSpan:8,className:"px-4 py-12 text-center text-gray-400",children:[(0,b.jsx)(g.FiFileText,{className:"mx-auto mb-2 h-10 w-10"}),(0,b.jsx)("p",{children:"No bills found."})]})}):i.map(a=>(0,b.jsxs)("tr",{className:"border-b border-gray-50 hover:bg-gray-50/50",children:[(0,b.jsx)("td",{className:"px-4 py-3 font-mono text-xs font-medium text-gray-800",children:a.billNumber}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("span",{className:"font-mono text-xs text-gray-600",children:["#","object"==typeof a.order&&null!==a.order?a.order._id.slice(-6).toUpperCase():String(a.order).slice(-6).toUpperCase()]})}),(0,b.jsx)("td",{className:"px-4 py-3 text-gray-600",children:"object"==typeof a.user&&null!==a.user?a.user.name:"Customer"}),(0,b.jsxs)("td",{className:"px-4 py-3 font-medium text-gray-800",children:["$",a.total.toFixed(2)]}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.isPaid?(0,b.jsx)("span",{className:"inline-block rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-600",children:z(a.paymentMethod)}):(0,b.jsx)("select",{value:s[a._id]||"cash",onChange:b=>t(c=>({...c,[a._id]:b.target.value})),className:"rounded-lg border border-gray-200 px-2 py-1 text-xs focus:border-[#c47a5a] focus:outline-none focus:ring-1 focus:ring-[#c47a5a]",children:h.map(a=>(0,b.jsx)("option",{value:a,children:z(a)},a))})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)("span",{className:`inline-block rounded-full px-2.5 py-0.5 text-xs font-medium ${a.isPaid?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:a.isPaid?"Paid":"Unpaid"})}),(0,b.jsx)("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(a.createdAt).toLocaleDateString()}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[!a.isPaid&&(0,b.jsxs)("button",{onClick:()=>x(a._id),disabled:q===a._id,className:"inline-flex items-center gap-1 rounded-lg bg-green-50 px-3 py-1.5 text-xs font-medium text-green-700 transition-colors hover:bg-green-100 disabled:opacity-50",children:[(0,b.jsx)(g.FiCheck,{className:"h-3.5 w-3.5"}),q===a._id?"Paying...":"Mark Paid"]}),(0,b.jsxs)("button",{onClick:()=>y(a._id),disabled:u===a._id,className:"inline-flex items-center gap-1 rounded-lg bg-[#c47a5a]/10 px-3 py-1.5 text-xs font-medium text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/20 disabled:opacity-50",children:[(0,b.jsx)(g.FiDownload,{className:"h-3.5 w-3.5"}),u===a._id?"...":"PDF"]})]})})]},a._id))})]})}),k.pages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["Showing page ",k.page," of ",k.pages," (",k.total," bills)"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>l(a=>({...a,page:a.page-1})),disabled:k.page<=1,className:"rounded-lg border border-gray-200 p-2 text-gray-600 transition-colors hover:bg-gray-50 disabled:opacity-50",children:(0,b.jsx)(g.FiChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)("button",{onClick:()=>l(a=>({...a,page:a.page+1})),disabled:k.page>=k.pages,className:"rounded-lg border border-gray-200 p-2 text-gray-600 transition-colors hover:bg-gray-50 disabled:opacity-50",children:(0,b.jsx)(g.FiChevronRight,{className:"h-4 w-4"})})]})]})]})}a.s(["default",()=>i])}];

//# sourceMappingURL=src_app_%28dashboard%29_%28admin%29_admin_bills_page_tsx_dd1db0c5._.js.map