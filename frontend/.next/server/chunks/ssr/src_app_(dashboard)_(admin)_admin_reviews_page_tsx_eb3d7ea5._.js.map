{"version":3,"sources":["../../../../src/app/%28dashboard%29/%28admin%29/admin/reviews/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport API from \"@/lib/api\";\nimport { Review, Pagination } from \"@/types\";\nimport toast from \"react-hot-toast\";\nimport {\n  FiChevronLeft,\n  FiChevronRight,\n  FiStar,\n  FiTrash2,\n  FiMessageSquare,\n} from \"react-icons/fi\";\n\nexport default function AdminReviewsPage() {\n  const [reviews, setReviews] = useState<Review[]>([]);\n  const [pagination, setPagination] = useState<Pagination>({ page: 1, limit: 10, total: 0, pages: 1 });\n  const [loading, setLoading] = useState(true);\n  const [deletingId, setDeletingId] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchReviews();\n  }, [pagination.page]);\n\n  const fetchReviews = async () => {\n    setLoading(true);\n    try {\n      const res = await API.get(\"/reviews\", {\n        params: { page: pagination.page, limit: pagination.limit },\n      });\n      setReviews(res.data.reviews || res.data.data || []);\n      if (res.data.pagination) setPagination(res.data.pagination);\n    } catch {\n      toast.error(\"Failed to load reviews\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async (id: string) => {\n    if (!confirm(\"Are you sure you want to delete this review?\")) return;\n    setDeletingId(id);\n    try {\n      await API.delete(`/reviews/${id}`);\n      setReviews((prev) => prev.filter((r) => r._id !== id));\n      toast.success(\"Review deleted\");\n    } catch (err: any) {\n      toast.error(err.response?.data?.message || \"Failed to delete review\");\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  const getUserName = (review: Review) => {\n    if (typeof review.user === \"object\" && review.user !== null) {\n      return review.user.name;\n    }\n    return \"User\";\n  };\n\n  const getProductName = (review: Review) => {\n    if (typeof review.product === \"object\" && review.product !== null) {\n      return (review.product as any).name || \"Product\";\n    }\n    return String(review.product).slice(-6).toUpperCase();\n  };\n\n  const truncateComment = (comment: string, maxLen = 60) => {\n    if (!comment) return \"â€”\";\n    return comment.length > maxLen ? comment.slice(0, maxLen) + \"...\" : comment;\n  };\n\n  if (loading && reviews.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"h-10 w-10 animate-spin rounded-full border-4 border-[#c47a5a] border-t-transparent\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div>\n        <h1 className=\"text-2xl font-bold text-gray-800\">Reviews</h1>\n        <p className=\"mt-1 text-gray-500\">Manage product reviews</p>\n      </div>\n\n      {/* Reviews Table */}\n      <div className=\"overflow-x-auto rounded-xl bg-white shadow-sm\">\n        <table className=\"w-full text-left text-sm\">\n          <thead>\n            <tr className=\"border-b border-gray-100\">\n              <th className=\"px-4 py-3 font-medium text-gray-500\">User</th>\n              <th className=\"px-4 py-3 font-medium text-gray-500\">Product</th>\n              <th className=\"px-4 py-3 font-medium text-gray-500\">Rating</th>\n              <th className=\"px-4 py-3 font-medium text-gray-500\">Comment</th>\n              <th className=\"px-4 py-3 font-medium text-gray-500\">Date</th>\n              <th className=\"px-4 py-3 font-medium text-gray-500\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {reviews.length === 0 ? (\n              <tr>\n                <td colSpan={6} className=\"px-4 py-12 text-center text-gray-400\">\n                  <FiMessageSquare className=\"mx-auto mb-2 h-10 w-10\" />\n                  <p>No reviews found.</p>\n                </td>\n              </tr>\n            ) : (\n              reviews.map((review) => (\n                <tr key={review._id} className=\"border-b border-gray-50 hover:bg-gray-50/50\">\n                  <td className=\"px-4 py-3 text-gray-800 font-medium\">\n                    {getUserName(review)}\n                  </td>\n                  <td className=\"px-4 py-3 text-gray-600\">\n                    {getProductName(review)}\n                  </td>\n                  <td className=\"px-4 py-3\">\n                    <div className=\"flex items-center gap-1\">\n                      {[1, 2, 3, 4, 5].map((s) => (\n                        <FiStar\n                          key={s}\n                          size={14}\n                          className={\n                            s <= review.rating\n                              ? \"fill-yellow-400 text-yellow-400\"\n                              : \"text-gray-300\"\n                          }\n                        />\n                      ))}\n                    </div>\n                  </td>\n                  <td className=\"px-4 py-3 text-gray-600 max-w-xs\">\n                    {truncateComment(review.comment)}\n                  </td>\n                  <td className=\"px-4 py-3 text-xs text-gray-500\">\n                    {new Date(review.createdAt).toLocaleDateString()}\n                  </td>\n                  <td className=\"px-4 py-3\">\n                    <button\n                      onClick={() => handleDelete(review._id)}\n                      disabled={deletingId === review._id}\n                      className=\"inline-flex items-center gap-1 rounded-lg bg-red-50 px-3 py-1.5 text-xs font-medium text-red-700 transition-colors hover:bg-red-100 disabled:opacity-50\"\n                    >\n                      <FiTrash2 className=\"h-3.5 w-3.5\" />\n                      {deletingId === review._id ? \"Deleting...\" : \"Delete\"}\n                    </button>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Pagination */}\n      {pagination.pages > 1 && (\n        <div className=\"flex items-center justify-between\">\n          <p className=\"text-sm text-gray-500\">\n            Showing page {pagination.page} of {pagination.pages} ({pagination.total} reviews)\n          </p>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => setPagination((p) => ({ ...p, page: p.page - 1 }))}\n              disabled={pagination.page <= 1}\n              className=\"rounded-lg border border-gray-200 p-2 text-gray-600 transition-colors hover:bg-gray-50 disabled:opacity-50\"\n            >\n              <FiChevronLeft className=\"h-4 w-4\" />\n            </button>\n            <button\n              onClick={() => setPagination((p) => ({ ...p, page: p.page + 1 }))}\n              disabled={pagination.page >= pagination.pages}\n              className=\"rounded-lg border border-gray-200 p-2 text-gray-600 transition-colors hover:bg-gray-50 disabled:opacity-50\"\n            >\n              <FiChevronRight className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}