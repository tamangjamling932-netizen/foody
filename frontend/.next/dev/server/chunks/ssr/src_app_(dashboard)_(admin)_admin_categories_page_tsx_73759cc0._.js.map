{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/trish/Documents/joseph/foody/frontend/src/app/%28dashboard%29/%28admin%29/admin/categories/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport API, { getImageUrl } from \"@/lib/api\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Category } from \"@/types\";\nimport Image from \"next/image\";\nimport toast from \"react-hot-toast\";\nimport {\n  FiPlus,\n  FiEdit2,\n  FiTrash2,\n  FiX,\n  FiUpload,\n  FiGrid,\n} from \"react-icons/fi\";\n\nexport default function AdminCategoriesPage() {\n  const { user } = useAuth();\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const [editingCategory, setEditingCategory] = useState<Category | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [deletingId, setDeletingId] = useState<string | null>(null);\n\n  // Form state\n  const [name, setName] = useState(\"\");\n  const [isActive, setIsActive] = useState(true);\n  const [imageFile, setImageFile] = useState<File | null>(null);\n  const [imagePreview, setImagePreview] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    fetchCategories();\n  }, []);\n\n  const fetchCategories = async () => {\n    setLoading(true);\n    try {\n      const res = await API.get(\"/categories\");\n      setCategories(res.data.categories || res.data || []);\n    } catch {\n      toast.error(\"Failed to load categories\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const openAddModal = () => {\n    setEditingCategory(null);\n    setName(\"\");\n    setIsActive(true);\n    setImageFile(null);\n    setImagePreview(null);\n    setShowModal(true);\n  };\n\n  const openEditModal = (category: Category) => {\n    setEditingCategory(category);\n    setName(category.name);\n    setIsActive(category.isActive);\n    setImageFile(null);\n    setImagePreview(category.image ? getImageUrl(category.image) : null);\n    setShowModal(true);\n  };\n\n  const closeModal = () => {\n    setShowModal(false);\n    setEditingCategory(null);\n    setImageFile(null);\n    setImagePreview(null);\n  };\n\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setImageFile(file);\n      setImagePreview(URL.createObjectURL(file));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!name.trim()) {\n      toast.error(\"Category name is required\");\n      return;\n    }\n\n    setSubmitting(true);\n    try {\n      const formData = new FormData();\n      formData.append(\"name\", name.trim());\n      formData.append(\"isActive\", String(isActive));\n      if (imageFile) formData.append(\"image\", imageFile);\n\n      if (editingCategory) {\n        await API.put(`/categories/${editingCategory._id}`, formData, {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n        });\n        toast.success(\"Category updated successfully\");\n      } else {\n        await API.post(\"/categories\", formData, {\n          headers: { \"Content-Type\": \"multipart/form-data\" },\n        });\n        toast.success(\"Category created successfully\");\n      }\n      closeModal();\n      fetchCategories();\n    } catch (err: any) {\n      toast.error(err.response?.data?.message || \"Failed to save category\");\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handleDelete = async (id: string) => {\n    if (deletingId) return;\n    setDeletingId(id);\n    try {\n      await API.delete(`/categories/${id}`);\n      toast.success(\"Category deleted\");\n      fetchCategories();\n    } catch (err: any) {\n      toast.error(err.response?.data?.message || \"Failed to delete category\");\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"h-10 w-10 animate-spin rounded-full border-4 border-[#c47a5a] border-t-transparent\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-800\">Categories</h1>\n          <p className=\"mt-1 text-gray-500\">Manage your menu categories</p>\n        </div>\n        <button\n          onClick={openAddModal}\n          className=\"inline-flex items-center gap-2 rounded-lg bg-[#c47a5a] px-4 py-2.5 text-sm font-medium text-white transition-colors hover:bg-[#b36a4a]\"\n        >\n          <FiPlus className=\"h-4 w-4\" /> Add Category\n        </button>\n      </div>\n\n      {/* Categories Grid */}\n      {categories.length === 0 ? (\n        <div className=\"rounded-xl bg-white p-12 text-center shadow-sm\">\n          <FiGrid className=\"mx-auto mb-3 h-12 w-12 text-gray-300\" />\n          <p className=\"text-gray-500\">No categories yet. Add your first category.</p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4\">\n          {categories.map((category) => (\n            <div\n              key={category._id}\n              className=\"group relative overflow-hidden rounded-xl bg-white shadow-sm transition-shadow hover:shadow-md\"\n            >\n              {/* Image */}\n              <div className=\"relative h-40 w-full overflow-hidden bg-gray-100\">\n                <Image\n                  src={getImageUrl(category.image)}\n                  alt={category.name}\n                  fill\n                  className=\"object-cover transition-transform group-hover:scale-105\"\n                />\n                {/* Status Badge */}\n                <div className=\"absolute left-3 top-3\">\n                  <span\n                    className={`inline-block rounded-full px-2.5 py-0.5 text-xs font-medium ${\n                      category.isActive\n                        ? \"bg-green-100 text-green-700\"\n                        : \"bg-gray-100 text-gray-500\"\n                    }`}\n                  >\n                    {category.isActive ? \"Active\" : \"Inactive\"}\n                  </span>\n                </div>\n                {/* Actions Overlay */}\n                <div className=\"absolute right-2 top-2 flex gap-1 opacity-0 transition-opacity group-hover:opacity-100\">\n                  <button\n                    onClick={() => openEditModal(category)}\n                    className=\"rounded-lg bg-white/90 p-2 text-gray-600 shadow-sm backdrop-blur-sm transition-colors hover:text-[#c47a5a]\"\n                  >\n                    <FiEdit2 className=\"h-4 w-4\" />\n                  </button>\n                  <button\n                    onClick={() => {\n                      if (confirm(\"Are you sure you want to delete this category?\")) {\n                        handleDelete(category._id);\n                      }\n                    }}\n                    disabled={deletingId === category._id}\n                    className=\"rounded-lg bg-white/90 p-2 text-gray-600 shadow-sm backdrop-blur-sm transition-colors hover:text-red-500 disabled:opacity-50\"\n                  >\n                    <FiTrash2 className=\"h-4 w-4\" />\n                  </button>\n                </div>\n              </div>\n\n              {/* Info */}\n              <div className=\"p-4\">\n                <h3 className=\"font-semibold text-gray-800\">{category.name}</h3>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Modal */}\n      {showModal && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n          <div className=\"w-full max-w-md rounded-xl bg-white p-6 shadow-xl\">\n            <div className=\"mb-4 flex items-center justify-between\">\n              <h2 className=\"text-lg font-semibold text-gray-800\">\n                {editingCategory ? \"Edit Category\" : \"Add Category\"}\n              </h2>\n              <button onClick={closeModal} className=\"rounded-lg p-1 text-gray-400 hover:text-gray-600\">\n                <FiX className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"mb-1 block text-sm font-medium text-gray-700\">Name</label>\n                <input\n                  type=\"text\"\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  placeholder=\"Category name\"\n                  className=\"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-[#c47a5a] focus:outline-none focus:ring-1 focus:ring-[#c47a5a]\"\n                />\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setIsActive(!isActive)}\n                  className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\n                    isActive ? \"bg-[#c47a5a]\" : \"bg-gray-300\"\n                  }`}\n                >\n                  <span\n                    className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\n                      isActive ? \"translate-x-6\" : \"translate-x-1\"\n                    }`}\n                  />\n                </button>\n                <span className=\"text-sm text-gray-700\">{isActive ? \"Active\" : \"Inactive\"}</span>\n              </div>\n\n              {/* Image Upload */}\n              <div>\n                <label className=\"mb-1 block text-sm font-medium text-gray-700\">Image</label>\n                <div\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-200 p-4 transition-colors hover:border-[#c47a5a]/50\"\n                >\n                  {imagePreview ? (\n                    <div className=\"relative h-32 w-full overflow-hidden rounded-lg\">\n                      <Image src={imagePreview} alt=\"Preview\" fill className=\"object-cover\" />\n                    </div>\n                  ) : (\n                    <>\n                      <FiUpload className=\"mb-2 h-8 w-8 text-gray-400\" />\n                      <p className=\"text-sm text-gray-500\">Click to upload image</p>\n                    </>\n                  )}\n                </div>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleImageChange}\n                  className=\"hidden\"\n                />\n              </div>\n\n              <div className=\"flex justify-end gap-3 pt-2\">\n                <button\n                  type=\"button\"\n                  onClick={closeModal}\n                  className=\"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={submitting}\n                  className=\"rounded-lg bg-[#c47a5a] px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-[#b36a4a] disabled:opacity-50\"\n                >\n                  {submitting ? \"Saving...\" : editingCategory ? \"Update\" : \"Create\"}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}