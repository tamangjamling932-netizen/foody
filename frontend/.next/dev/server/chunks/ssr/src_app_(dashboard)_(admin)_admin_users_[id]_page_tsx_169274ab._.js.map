{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/trish/Documents/joseph/foody/frontend/src/app/%28dashboard%29/%28admin%29/admin/users/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport API from \"@/lib/api\";\nimport { getImageUrl } from \"@/lib/api\";\nimport { User, Order } from \"@/types\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport toast from \"react-hot-toast\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport {\n  FiArrowLeft,\n  FiMail,\n  FiCalendar,\n  FiShield,\n  FiPackage,\n  FiUser,\n} from \"react-icons/fi\";\n\nconst ROLES = [\"customer\", \"staff\", \"admin\"] as const;\n\nconst roleColor = (role: string) => {\n  switch (role) {\n    case \"admin\":\n      return \"bg-red-100 text-red-700\";\n    case \"staff\":\n      return \"bg-blue-100 text-blue-700\";\n    case \"customer\":\n      return \"bg-gray-100 text-gray-600\";\n    default:\n      return \"bg-gray-100 text-gray-600\";\n  }\n};\n\nconst statusColor = (status: string) => {\n  switch (status) {\n    case \"pending\":\n      return \"bg-yellow-100 text-yellow-700\";\n    case \"confirmed\":\n      return \"bg-blue-100 text-blue-700\";\n    case \"preparing\":\n      return \"bg-orange-100 text-orange-700\";\n    case \"served\":\n      return \"bg-purple-100 text-purple-700\";\n    case \"completed\":\n      return \"bg-green-100 text-green-700\";\n    case \"cancelled\":\n      return \"bg-red-100 text-red-700\";\n    default:\n      return \"bg-gray-100 text-gray-600\";\n  }\n};\n\nexport default function AdminUserDetailPage() {\n  const params = useParams();\n  const router = useRouter();\n  const { user: currentUser } = useAuth();\n  const userId = params.id as string;\n\n  const [user, setUser] = useState<User | null>(null);\n  const [orders, setOrders] = useState<Order[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [updatingRole, setUpdatingRole] = useState(false);\n\n  useEffect(() => {\n    if (!userId) return;\n    fetchUserData();\n  }, [userId]);\n\n  const fetchUserData = async () => {\n    setLoading(true);\n    setError(\"\");\n    try {\n      const [userRes, ordersRes] = await Promise.all([\n        API.get(`/users/${userId}`),\n        API.get(`/users/${userId}/orders`).catch(() => ({ data: { orders: [] } })),\n      ]);\n      setUser(userRes.data.user || userRes.data);\n      setOrders(ordersRes.data.orders || ordersRes.data || []);\n    } catch (err: any) {\n      setError(err.response?.data?.message || \"Failed to load user details\");\n      toast.error(\"Failed to load user details\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRoleChange = async (newRole: string) => {\n    if (!user) return;\n    if (user._id === currentUser?._id) {\n      toast.error(\"You cannot change your own role\");\n      return;\n    }\n    setUpdatingRole(true);\n    try {\n      await API.put(`/users/${userId}/role`, { role: newRole });\n      setUser((prev) => (prev ? { ...prev, role: newRole as User[\"role\"] } : prev));\n      toast.success(`Role updated to ${newRole}`);\n    } catch (err: any) {\n      toast.error(err.response?.data?.message || \"Failed to update role\");\n    } finally {\n      setUpdatingRole(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"h-10 w-10 animate-spin rounded-full border-4 border-[#c47a5a] border-t-transparent\" />\n      </div>\n    );\n  }\n\n  if (error || !user) {\n    return (\n      <div className=\"space-y-4 py-20 text-center\">\n        <p className=\"text-gray-500\">{error || \"User not found\"}</p>\n        <Link\n          href=\"/admin/users\"\n          className=\"inline-flex items-center gap-2 text-sm text-[#c47a5a] hover:underline\"\n        >\n          <FiArrowLeft className=\"h-4 w-4\" />\n          Back to Users\n        </Link>\n      </div>\n    );\n  }\n\n  const isSelf = user._id === currentUser?._id;\n  const initials = user.name\n    .split(\" \")\n    .map((n) => n[0])\n    .join(\"\")\n    .toUpperCase()\n    .slice(0, 2);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Link */}\n      <Link\n        href=\"/admin/users\"\n        className=\"inline-flex items-center gap-2 text-sm text-gray-500 hover:text-[#c47a5a] transition-colors\"\n      >\n        <FiArrowLeft className=\"h-4 w-4\" />\n        Back to Users\n      </Link>\n\n      {/* User Info Card */}\n      <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n        <div className=\"flex flex-col gap-6 sm:flex-row sm:items-start\">\n          {/* Avatar */}\n          <div className=\"flex-shrink-0\">\n            {user.avatar ? (\n              <Image\n                src={getImageUrl(user.avatar)}\n                alt={user.name}\n                width={80}\n                height={80}\n                className=\"h-20 w-20 rounded-full object-cover\"\n              />\n            ) : (\n              <div className=\"flex h-20 w-20 items-center justify-center rounded-full bg-[#c47a5a]/10 text-2xl font-bold text-[#c47a5a]\">\n                {initials}\n              </div>\n            )}\n          </div>\n\n          {/* Details */}\n          <div className=\"flex-1 space-y-3\">\n            <div>\n              <h1 className=\"text-2xl font-bold text-gray-800\">\n                {user.name}\n                {isSelf && (\n                  <span className=\"ml-2 text-sm font-normal text-gray-400\">(you)</span>\n                )}\n              </h1>\n            </div>\n\n            <div className=\"flex flex-wrap gap-4 text-sm text-gray-500\">\n              <div className=\"flex items-center gap-1.5\">\n                <FiMail className=\"h-4 w-4\" />\n                {user.email}\n              </div>\n              <div className=\"flex items-center gap-1.5\">\n                <FiCalendar className=\"h-4 w-4\" />\n                Joined {new Date(user.createdAt).toLocaleDateString()}\n              </div>\n            </div>\n\n            {/* Role Management */}\n            <div className=\"flex items-center gap-3\">\n              <FiShield className=\"h-4 w-4 text-gray-400\" />\n              {isSelf ? (\n                <span\n                  className={`inline-block rounded-full px-3 py-1 text-xs font-medium capitalize ${roleColor(user.role)}`}\n                >\n                  {user.role}\n                </span>\n              ) : (\n                <select\n                  value={user.role}\n                  onChange={(e) => handleRoleChange(e.target.value)}\n                  disabled={updatingRole}\n                  className={`rounded-full px-3 py-1 text-xs font-medium capitalize ${roleColor(user.role)} cursor-pointer border-none focus:outline-none focus:ring-2 focus:ring-[#c47a5a] disabled:opacity-50`}\n                >\n                  {ROLES.map((r) => (\n                    <option key={r} value={r}>\n                      {r}\n                    </option>\n                  ))}\n                </select>\n              )}\n              {updatingRole && (\n                <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-[#c47a5a] border-t-transparent\" />\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Order History */}\n      <div className=\"rounded-xl bg-white shadow-sm\">\n        <div className=\"border-b border-gray-100 px-6 py-4\">\n          <h2 className=\"flex items-center gap-2 text-lg font-semibold text-gray-800\">\n            <FiPackage className=\"h-5 w-5 text-[#c47a5a]\" />\n            Order History\n            <span className=\"ml-1 text-sm font-normal text-gray-400\">\n              ({orders.length})\n            </span>\n          </h2>\n        </div>\n\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-left text-sm\">\n            <thead>\n              <tr className=\"border-b border-gray-100\">\n                <th className=\"px-6 py-3 font-medium text-gray-500\">Order ID</th>\n                <th className=\"px-6 py-3 font-medium text-gray-500\">Items</th>\n                <th className=\"px-6 py-3 font-medium text-gray-500\">Total</th>\n                <th className=\"px-6 py-3 font-medium text-gray-500\">Status</th>\n                <th className=\"px-6 py-3 font-medium text-gray-500\">Date</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.length === 0 ? (\n                <tr>\n                  <td colSpan={5} className=\"px-6 py-12 text-center text-gray-400\">\n                    <FiPackage className=\"mx-auto mb-2 h-10 w-10\" />\n                    <p>No orders found for this user.</p>\n                  </td>\n                </tr>\n              ) : (\n                orders.map((order) => (\n                  <tr\n                    key={order._id}\n                    className=\"border-b border-gray-50 hover:bg-gray-50/50\"\n                  >\n                    <td className=\"px-6 py-3 font-mono text-xs text-gray-600\">\n                      {order._id.slice(-8).toUpperCase()}\n                    </td>\n                    <td className=\"px-6 py-3 text-gray-600\">\n                      {order.items.length} item{order.items.length !== 1 && \"s\"}\n                    </td>\n                    <td className=\"px-6 py-3 font-medium text-gray-800\">\n                      ${order.total.toFixed(2)}\n                    </td>\n                    <td className=\"px-6 py-3\">\n                      <span\n                        className={`inline-block rounded-full px-2.5 py-0.5 text-xs font-medium capitalize ${statusColor(order.status)}`}\n                      >\n                        {order.status}\n                      </span>\n                    </td>\n                    <td className=\"px-6 py-3 text-xs text-gray-500\">\n                      {new Date(order.createdAt).toLocaleDateString()}\n                    </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}