{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/trish/Documents/joseph/foody/frontend/src/lib/currency.ts"],"sourcesContent":["// Nepali Rupee currency formatter\nexport const CURRENCY_SYMBOL = \"â‚¨\"; // Nepali Rupee Symbol\nexport const CURRENCY_CODE = \"NPR\";\n\nexport function formatCurrency(amount: number): string {\n  return `${CURRENCY_SYMBOL} ${amount.toFixed(2)}`;\n}\n\nexport function formatCurrencyCompact(amount: number): string {\n  return `${CURRENCY_SYMBOL}${amount.toFixed(2)}`;\n}\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;;;;;;AAC3B,MAAM,kBAAkB,KAAK,sBAAsB;AACnD,MAAM,gBAAgB;AAEtB,SAAS,eAAe,MAAc;IAC3C,OAAO,GAAG,gBAAgB,CAAC,EAAE,OAAO,OAAO,CAAC,IAAI;AAClD;AAEO,SAAS,sBAAsB,MAAc;IAClD,OAAO,GAAG,kBAAkB,OAAO,OAAO,CAAC,IAAI;AACjD"}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/trish/Documents/joseph/foody/frontend/src/app/%28dashboard%29/%28customer%29/orders/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport API, { getImageUrl } from \"@/lib/api\";\nimport { Order, Bill } from \"@/types\";\nimport toast from \"react-hot-toast\";\nimport {\n  FiArrowLeft,\n  FiClock,\n  FiPackage,\n  FiCheckCircle,\n  FiXCircle,\n  FiFileText,\n  FiDownload,\n  FiCreditCard,\n  FiPrinter,\n  FiShoppingCart,\n  FiStar,\n  FiEdit3,\n} from \"react-icons/fi\";\nimport { formatCurrency } from \"@/lib/currency\";\n\nconst STATUS_COLORS: Record<string, { bg: string; text: string; dot: string }> = {\n  pending: { bg: \"bg-yellow-50\", text: \"text-yellow-700\", dot: \"bg-yellow-500\" },\n  confirmed: { bg: \"bg-blue-50\", text: \"text-blue-700\", dot: \"bg-blue-500\" },\n  preparing: { bg: \"bg-orange-50\", text: \"text-orange-700\", dot: \"bg-orange-500\" },\n  served: { bg: \"bg-purple-50\", text: \"text-purple-700\", dot: \"bg-purple-500\" },\n  completed: { bg: \"bg-green-50\", text: \"text-green-700\", dot: \"bg-green-500\" },\n  cancelled: { bg: \"bg-red-50\", text: \"text-red-700\", dot: \"bg-red-500\" },\n};\n\nconst STATUS_STEPS = [\"pending\", \"confirmed\", \"preparing\", \"served\", \"completed\"];\n\nconst PAYMENT_METHODS = [\n  { value: \"cash\", label: \"Cash\" },\n  { value: \"esewa\", label: \"eSewa\" },\n  { value: \"khalti\", label: \"Khalti\" },\n  { value: \"bank\", label: \"Bank Transfer\" },\n] as const;\n\ninterface ReviewState {\n  [productId: string]: { rating: number; comment: string; submitted: boolean };\n}\n\nexport default function OrderDetailPage() {\n  const params = useParams();\n  const router = useRouter();\n  const orderId = params.id as string;\n\n  const [order, setOrder] = useState<Order | null>(null);\n  const [bill, setBill] = useState<Bill | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [generatingBill, setGeneratingBill] = useState(false);\n  const [payingBill, setPayingBill] = useState(false);\n  const [selectedPayment, setSelectedPayment] = useState<\"cash\" | \"esewa\" | \"khalti\" | \"bank\">(\"cash\");\n  const [reordering, setReordering] = useState(false);\n  const [reviews, setReviews] = useState<ReviewState>({});\n  const [submittingReview, setSubmittingReview] = useState<string | null>(null);\n  const [existingReviews, setExistingReviews] = useState<Record<string, boolean>>({});\n\n  useEffect(() => {\n    if (orderId) fetchOrder();\n  }, [orderId]);\n\n  const fetchOrder = async () => {\n    setLoading(true);\n    try {\n      const res = await API.get(`/orders/${orderId}`);\n      const fetchedOrder = res.data.order || res.data;\n      setOrder(fetchedOrder);\n      await Promise.all([checkBill(), checkExistingReviews(fetchedOrder)]);\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Failed to load order\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const checkBill = async () => {\n    try {\n      const res = await API.get(`/bills?order=${orderId}`);\n      const bills = res.data.bills || res.data || [];\n      if (Array.isArray(bills) && bills.length > 0) {\n        setBill(bills[0]);\n      } else if (res.data.bill) {\n        setBill(res.data.bill);\n      }\n    } catch {\n      // No bill exists yet\n    }\n  };\n\n  const checkExistingReviews = async (fetchedOrder: Order) => {\n    if (fetchedOrder.status !== \"completed\") return;\n    try {\n      const productIds = fetchedOrder.items.map((item) => item.product);\n      const existing: Record<string, boolean> = {};\n      await Promise.all(\n        productIds.map(async (productId) => {\n          try {\n            const res = await API.get(`/reviews/product/${productId}?limit=100`);\n            // We'll mark as submitted if user already reviewed - backend should handle this\n            existing[productId] = false;\n          } catch {\n            existing[productId] = false;\n          }\n        })\n      );\n      setExistingReviews(existing);\n    } catch {\n      // Ignore\n    }\n  };\n\n  const requestBillWithOptions = async (options: { callWaiter?: boolean } = {}) => {\n    setGeneratingBill(true);\n    try {\n      const res = await API.post(`/bills/${orderId}/request`, {\n        callWaiter: options.callWaiter || false,\n      });\n      setBill(res.data.bill || res.data);\n      toast.success(\n        options.callWaiter ? \"Waiter has been called for your bill!\" : \"Bill requested successfully!\"\n      );\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Failed to request bill\");\n    } finally {\n      setGeneratingBill(false);\n    }\n  };\n\n  const downloadPdf = () => {\n    if (!bill) return;\n    const token = typeof window !== \"undefined\" ? localStorage.getItem(\"token\") : null;\n    const baseUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:5000/api\";\n    window.open(`${baseUrl}/bills/${bill._id}/pdf?token=${token}`, \"_blank\");\n  };\n\n  const printReceipt = () => {\n    window.print();\n  };\n\n  const payBill = async () => {\n    if (!bill) return;\n    setPayingBill(true);\n    try {\n      const res = await API.put(`/bills/${bill._id}/pay`, { paymentMethod: selectedPayment });\n      setBill(res.data.bill || res.data);\n      const orderRes = await API.get(`/orders/${orderId}`);\n      setOrder(orderRes.data.order || orderRes.data);\n      toast.success(\"Payment successful!\");\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Payment failed\");\n    } finally {\n      setPayingBill(false);\n    }\n  };\n\n  const reorder = async () => {\n    if (!order) return;\n    setReordering(true);\n    try {\n      await Promise.all(\n        order.items.map((item) =>\n          API.post(\"/cart/add\", { productId: item.product, quantity: item.quantity })\n        )\n      );\n      toast.success(\"Items added to cart!\");\n      router.push(\"/cart\");\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Failed to reorder\");\n    } finally {\n      setReordering(false);\n    }\n  };\n\n  const setItemRating = (productId: string, rating: number) => {\n    setReviews((prev) => ({\n      ...prev,\n      [productId]: { ...prev[productId], rating, comment: prev[productId]?.comment || \"\" },\n    }));\n  };\n\n  const setItemComment = (productId: string, comment: string) => {\n    setReviews((prev) => ({\n      ...prev,\n      [productId]: { ...prev[productId], comment, rating: prev[productId]?.rating || 0 },\n    }));\n  };\n\n  const submitReview = async (productId: string, itemName: string) => {\n    const review = reviews[productId];\n    if (!review?.rating) {\n      toast.error(\"Please select a rating\");\n      return;\n    }\n    setSubmittingReview(productId);\n    try {\n      await API.post(\"/reviews\", {\n        product: productId,\n        order: orderId,\n        rating: review.rating,\n        comment: review.comment,\n      });\n      setReviews((prev) => ({\n        ...prev,\n        [productId]: { ...prev[productId], submitted: true },\n      }));\n      toast.success(`Review for ${itemName} submitted!`);\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || \"Failed to submit review\");\n    } finally {\n      setSubmittingReview(null);\n    }\n  };\n\n  const formatDate = (dateStr: string) =>\n    new Date(dateStr).toLocaleDateString(\"en-NP\", {\n      day: \"numeric\",\n      month: \"short\",\n      year: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n\n  const getStepStatus = (step: string, currentStatus: string) => {\n    if (currentStatus === \"cancelled\") return \"cancelled\";\n    const stepIdx = STATUS_STEPS.indexOf(step);\n    const currentIdx = STATUS_STEPS.indexOf(currentStatus);\n    if (stepIdx < currentIdx) return \"done\";\n    if (stepIdx === currentIdx) return \"active\";\n    return \"upcoming\";\n  };\n\n  const isServed = order?.status === \"served\";\n  const isCompleted = order?.status === \"completed\";\n  const isCancelled = order?.status === \"cancelled\";\n\n  if (loading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"h-5 w-32 rounded bg-gray-200 animate-pulse\" />\n        <div className=\"rounded-xl bg-white p-6 shadow-sm animate-pulse space-y-3\">\n          <div className=\"h-6 w-48 rounded bg-gray-200\" />\n          <div className=\"h-4 w-64 rounded bg-gray-200\" />\n        </div>\n        <div className=\"rounded-xl bg-white p-6 shadow-sm animate-pulse\">\n          {Array.from({ length: 3 }).map((_, i) => (\n            <div key={i} className=\"flex gap-4 py-4 border-b border-gray-50 last:border-0\">\n              <div className=\"h-16 w-16 shrink-0 rounded-lg bg-gray-200\" />\n              <div className=\"flex-1 space-y-2\">\n                <div className=\"h-4 w-3/4 rounded bg-gray-200\" />\n                <div className=\"h-3 w-1/4 rounded bg-gray-200\" />\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (!order) {\n    return (\n      <div className=\"space-y-6\">\n        <Link href=\"/orders\" className=\"inline-flex items-center gap-2 text-sm font-medium text-[#c47a5a] hover:underline\">\n          <FiArrowLeft className=\"h-4 w-4\" /> Back to Orders\n        </Link>\n        <div className=\"rounded-xl bg-white py-20 text-center shadow-sm\">\n          <FiPackage className=\"mx-auto mb-4 h-16 w-16 text-gray-300\" />\n          <p className=\"text-lg font-medium text-gray-500\">Order not found</p>\n        </div>\n      </div>\n    );\n  }\n\n  const colors = STATUS_COLORS[order.status];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Back Link */}\n      <Link href=\"/orders\" className=\"inline-flex items-center gap-2 text-sm font-medium text-[#c47a5a] hover:underline\">\n        <FiArrowLeft className=\"h-4 w-4\" /> Back to Orders\n      </Link>\n\n      {/* Order Header */}\n      <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n        <div className=\"flex flex-wrap items-start justify-between gap-4\">\n          <div className=\"space-y-1.5\">\n            <h1 className=\"text-xl font-bold text-gray-800\">\n              Order #{order._id.slice(-6).toUpperCase()}\n            </h1>\n            <div className=\"flex flex-wrap items-center gap-3 text-sm text-gray-500\">\n              <span className=\"flex items-center gap-1.5\">\n                <FiClock className=\"h-4 w-4\" />\n                {formatDate(order.createdAt)}\n              </span>\n              {order.tableNumber && (\n                <span className=\"flex items-center gap-1.5\">\n                  <FiPackage className=\"h-4 w-4\" />\n                  Table {order.tableNumber}\n                </span>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap items-center gap-2\">\n            <span className={`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-sm font-medium ${colors.bg} ${colors.text}`}>\n              <span className={`h-2 w-2 rounded-full ${colors.dot}`} />\n              {order.status.charAt(0).toUpperCase() + order.status.slice(1)}\n            </span>\n            <span className={`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-sm font-medium ${order.isPaid ? \"bg-green-50 text-green-700\" : \"bg-gray-100 text-gray-500\"}`}>\n              {order.isPaid ? <FiCheckCircle className=\"h-3.5 w-3.5\" /> : <FiXCircle className=\"h-3.5 w-3.5\" />}\n              {order.isPaid ? \"Paid\" : \"Unpaid\"}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      {/* Order Status Tracker */}\n      {!isCancelled && (\n        <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n          <h2 className=\"mb-5 text-base font-semibold text-gray-800\">Order Progress</h2>\n          <div className=\"relative flex items-center justify-between\">\n            {/* Progress Line */}\n            <div className=\"absolute left-0 right-0 top-4 h-0.5 bg-gray-200 z-0\" />\n            <div\n              className=\"absolute left-0 top-4 h-0.5 bg-[#c47a5a] z-0 transition-all duration-500\"\n              style={{\n                width: `${(STATUS_STEPS.indexOf(order.status) / (STATUS_STEPS.length - 1)) * 100}%`,\n              }}\n            />\n\n            {STATUS_STEPS.map((step) => {\n              const stepStatus = getStepStatus(step, order.status);\n              return (\n                <div key={step} className=\"relative z-10 flex flex-col items-center gap-1.5\">\n                  <div\n                    className={`flex h-8 w-8 items-center justify-center rounded-full border-2 transition-all ${\n                      stepStatus === \"done\"\n                        ? \"border-[#c47a5a] bg-[#c47a5a]\"\n                        : stepStatus === \"active\"\n                        ? \"border-[#c47a5a] bg-white\"\n                        : \"border-gray-300 bg-white\"\n                    }`}\n                  >\n                    {stepStatus === \"done\" ? (\n                      <FiCheckCircle className=\"h-4 w-4 text-white\" />\n                    ) : (\n                      <span\n                        className={`h-2.5 w-2.5 rounded-full ${\n                          stepStatus === \"active\" ? \"bg-[#c47a5a]\" : \"bg-gray-300\"\n                        }`}\n                      />\n                    )}\n                  </div>\n                  <span\n                    className={`text-xs font-medium capitalize ${\n                      stepStatus === \"active\" ? \"text-[#c47a5a]\" : stepStatus === \"done\" ? \"text-gray-600\" : \"text-gray-400\"\n                    }`}\n                  >\n                    {step}\n                  </span>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Cancelled Banner */}\n      {isCancelled && (\n        <div className=\"rounded-xl border border-red-200 bg-red-50 p-4 flex items-center gap-3\">\n          <FiXCircle className=\"h-5 w-5 shrink-0 text-red-500\" />\n          <p className=\"text-sm font-medium text-red-700\">This order has been cancelled.</p>\n        </div>\n      )}\n\n      {/* Order Items */}\n      <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-lg font-semibold text-gray-800\">Items ({order.items.length})</h2>\n          {/* Reorder Button */}\n          <button\n            onClick={reorder}\n            disabled={reordering}\n            className=\"flex items-center gap-1.5 rounded-lg border border-[#c47a5a] px-3 py-1.5 text-sm font-medium text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5 disabled:opacity-50\"\n          >\n            {reordering ? (\n              <span className=\"h-4 w-4 animate-spin rounded-full border-2 border-[#c47a5a] border-t-transparent\" />\n            ) : (\n              <FiShoppingCart className=\"h-4 w-4\" />\n            )}\n            {reordering ? \"Adding...\" : \"Reorder\"}\n          </button>\n        </div>\n        <div className=\"divide-y divide-gray-100\">\n          {order.items.map((item, index) => (\n            <div key={index} className=\"flex items-center gap-4 py-4 first:pt-0 last:pb-0\">\n              <Image\n                src={getImageUrl(item.image)}\n                alt={item.name}\n                width={64}\n                height={64}\n                unoptimized\n                className=\"h-16 w-16 shrink-0 rounded-lg object-cover\"\n              />\n              <div className=\"min-w-0 flex-1\">\n                <p className=\"text-sm font-semibold text-gray-800\">{item.name}</p>\n                <p className=\"mt-0.5 text-xs text-gray-500\">\n                  {formatCurrency(item.price)} x {item.quantity}\n                </p>\n              </div>\n              <span className=\"shrink-0 text-sm font-semibold text-gray-800\">\n                {formatCurrency(item.price * item.quantity)}\n              </span>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Notes */}\n      {order.notes && (\n        <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n          <h2 className=\"mb-2 text-lg font-semibold text-gray-800\">Notes</h2>\n          <p className=\"text-sm text-gray-600\">{order.notes}</p>\n        </div>\n      )}\n\n      {/* Order Summary */}\n      <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n        <h2 className=\"mb-4 text-lg font-semibold text-gray-800\">Order Summary</h2>\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-gray-500\">Subtotal</span>\n            <span className=\"font-medium text-gray-700\">{formatCurrency(order.subtotal)}</span>\n          </div>\n          <div className=\"flex items-center justify-between text-sm\">\n            <span className=\"text-gray-500\">Tax</span>\n            <span className=\"font-medium text-gray-700\">{formatCurrency(order.tax)}</span>\n          </div>\n          <div className=\"border-t border-gray-100 pt-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-base font-semibold text-gray-800\">Total</span>\n              <span className=\"text-xl font-bold text-gray-800\">{formatCurrency(order.total)}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* BILLING SECTION */}\n\n      {/* Served: Show Request Bill / Call Waiter */}\n      {isServed && (\n        <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n          <h2 className=\"mb-4 text-lg font-semibold text-gray-800\">Billing</h2>\n\n          {!bill ? (\n            <div className=\"flex flex-col gap-3 sm:flex-row\">\n              <button\n                onClick={() => requestBillWithOptions()}\n                disabled={generatingBill}\n                className=\"flex flex-1 items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3 font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                {generatingBill ? (\n                  <span className=\"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n                ) : (\n                  <FiFileText className=\"h-5 w-5\" />\n                )}\n                {generatingBill ? \"Requesting...\" : \"Request Bill\"}\n              </button>\n              <button\n                onClick={() => requestBillWithOptions({ callWaiter: true })}\n                disabled={generatingBill}\n                className=\"flex flex-1 items-center justify-center gap-2 rounded-xl border-2 border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5 disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                <FiClock className=\"h-5 w-5\" />\n                Call Waiter for Bill\n              </button>\n            </div>\n          ) : (bill as any).status === \"requested\" ? (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-2 rounded-lg bg-yellow-50 border border-yellow-200 p-3\">\n                <FiClock className=\"h-5 w-5 text-yellow-600\" />\n                <span className=\"font-semibold text-yellow-700\">Waiting for staff confirmation...</span>\n              </div>\n              <BillDetails bill={bill} formatDate={formatDate} />\n              <button onClick={downloadPdf} className=\"flex w-full items-center justify-center gap-2 rounded-xl border border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] hover:bg-[#c47a5a]/5\">\n                <FiDownload className=\"h-5 w-5\" /> Download PDF\n              </button>\n              {!bill.isPaid && (\n                <PaymentSection\n                  selectedPayment={selectedPayment}\n                  setSelectedPayment={setSelectedPayment}\n                  payBill={payBill}\n                  payingBill={payingBill}\n                />\n              )}\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {bill.isPaid && (\n                <div className=\"flex items-center justify-center gap-2 rounded-lg bg-green-50 border border-green-200 p-3\">\n                  <FiCheckCircle className=\"h-5 w-5 text-green-600\" />\n                  <span className=\"font-semibold text-green-700\">Paid</span>\n                  {bill.paymentMethod && (\n                    <span className=\"text-sm text-green-600\">via <span className=\"capitalize\">{bill.paymentMethod}</span></span>\n                  )}\n                </div>\n              )}\n              <BillDetails bill={bill} formatDate={formatDate} />\n              <button onClick={downloadPdf} className=\"flex w-full items-center justify-center gap-2 rounded-xl border border-[#c47a5a] px-6 py-3 font-semibold text-[#c47a5a] hover:bg-[#c47a5a]/5\">\n                <FiDownload className=\"h-5 w-5\" /> Download PDF\n              </button>\n              {!bill.isPaid && (\n                <PaymentSection\n                  selectedPayment={selectedPayment}\n                  setSelectedPayment={setSelectedPayment}\n                  payBill={payBill}\n                  payingBill={payingBill}\n                />\n              )}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Completed: Show Receipt / Print Statement */}\n      {isCompleted && (\n        <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n          <div className=\"mb-4 flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold text-gray-800\">Receipt</h2>\n            {bill && (\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={downloadPdf}\n                  className=\"flex items-center gap-1.5 rounded-lg border border-gray-200 px-3 py-1.5 text-sm font-medium text-gray-600 transition-colors hover:bg-gray-50\"\n                >\n                  <FiDownload className=\"h-4 w-4\" /> PDF\n                </button>\n                <button\n                  onClick={printReceipt}\n                  className=\"flex items-center gap-1.5 rounded-lg border border-[#c47a5a] px-3 py-1.5 text-sm font-medium text-[#c47a5a] transition-colors hover:bg-[#c47a5a]/5\"\n                >\n                  <FiPrinter className=\"h-4 w-4\" /> Print\n                </button>\n              </div>\n            )}\n          </div>\n\n          {/* Receipt body */}\n          <div className=\"rounded-xl border border-gray-100 bg-gray-50 p-5 space-y-4\">\n            {/* Receipt Header */}\n            <div className=\"text-center border-b border-dashed border-gray-300 pb-4\">\n              <p className=\"text-lg font-bold text-gray-800\">Foody Restaurant</p>\n              <p className=\"text-xs text-gray-500\">Thank you for dining with us!</p>\n              <p className=\"text-xs text-gray-400 mt-1\">Order #{order._id.slice(-6).toUpperCase()}</p>\n              <p className=\"text-xs text-gray-400\">{formatDate(order.createdAt)}</p>\n              {order.tableNumber && <p className=\"text-xs text-gray-400\">Table {order.tableNumber}</p>}\n            </div>\n\n            {/* Items */}\n            <div className=\"space-y-2\">\n              {order.items.map((item, idx) => (\n                <div key={idx} className=\"flex items-center justify-between text-sm\">\n                  <span className=\"text-gray-700\">\n                    {item.name} <span className=\"text-gray-400\">x{item.quantity}</span>\n                  </span>\n                  <span className=\"font-medium text-gray-800\">{formatCurrency(item.price * item.quantity)}</span>\n                </div>\n              ))}\n            </div>\n\n            {/* Totals */}\n            <div className=\"border-t border-dashed border-gray-300 pt-3 space-y-1.5\">\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-500\">Subtotal</span>\n                <span className=\"font-medium\">{formatCurrency(order.subtotal)}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-500\">Tax</span>\n                <span className=\"font-medium\">{formatCurrency(order.tax)}</span>\n              </div>\n              <div className=\"flex justify-between text-base font-bold text-gray-800 pt-1.5 border-t border-gray-200\">\n                <span>Total</span>\n                <span>{formatCurrency(order.total)}</span>\n              </div>\n            </div>\n\n            {/* Payment Info */}\n            {bill && (\n              <div className=\"border-t border-dashed border-gray-300 pt-3 space-y-1.5\">\n                {bill.billNumber && (\n                  <div className=\"flex justify-between text-xs text-gray-500\">\n                    <span>Bill No.</span>\n                    <span className=\"font-medium\">{bill.billNumber}</span>\n                  </div>\n                )}\n                {bill.paymentMethod && (\n                  <div className=\"flex justify-between text-xs text-gray-500\">\n                    <span>Payment</span>\n                    <span className=\"font-medium capitalize\">{bill.paymentMethod}</span>\n                  </div>\n                )}\n                <div className=\"flex justify-between text-xs\">\n                  <span className=\"text-gray-500\">Status</span>\n                  <span className={`font-semibold ${bill.isPaid ? \"text-green-600\" : \"text-red-500\"}`}>\n                    {bill.isPaid ? \"PAID\" : \"UNPAID\"}\n                  </span>\n                </div>\n                {bill.isPaid && bill.paidAt && (\n                  <div className=\"flex justify-between text-xs text-gray-500\">\n                    <span>Paid at</span>\n                    <span className=\"font-medium\">{formatDate(bill.paidAt)}</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* No bill yet */}\n            {!bill && (\n              <div className=\"rounded-lg border border-yellow-200 bg-yellow-50 p-3 text-center\">\n                <p className=\"text-sm text-yellow-700\">Bill not yet generated. Please contact staff.</p>\n              </div>\n            )}\n\n            {/* Pay if unpaid */}\n            {bill && !bill.isPaid && (\n              <PaymentSection\n                selectedPayment={selectedPayment}\n                setSelectedPayment={setSelectedPayment}\n                payBill={payBill}\n                payingBill={payingBill}\n              />\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Review Section - Only for completed orders */}\n      {isCompleted && (\n        <div className=\"rounded-xl bg-white p-6 shadow-sm\">\n          <div className=\"mb-5 flex items-center gap-2\">\n            <FiEdit3 className=\"h-5 w-5 text-[#c47a5a]\" />\n            <h2 className=\"text-lg font-semibold text-gray-800\">Rate Your Experience</h2>\n          </div>\n\n          <div className=\"space-y-5\">\n            {order.items.map((item, idx) => {\n              const productId = item.product;\n              const review = reviews[productId] || { rating: 0, comment: \"\", submitted: false };\n\n              return (\n                <div key={idx} className=\"rounded-xl border border-gray-100 p-4\">\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <Image\n                      src={getImageUrl(item.image)}\n                      alt={item.name}\n                      width={48}\n                      height={48}\n                      unoptimized\n                      className=\"h-12 w-12 rounded-lg object-cover\"\n                    />\n                    <div>\n                      <p className=\"text-sm font-semibold text-gray-800\">{item.name}</p>\n                      <p className=\"text-xs text-gray-500\">{formatCurrency(item.price)}</p>\n                    </div>\n                  </div>\n\n                  {review.submitted ? (\n                    <div className=\"flex items-center gap-2 rounded-lg bg-green-50 p-3\">\n                      <FiCheckCircle className=\"h-4 w-4 text-green-600\" />\n                      <span className=\"text-sm text-green-700 font-medium\">Review submitted!</span>\n                      <div className=\"flex ml-2\">\n                        {[1, 2, 3, 4, 5].map((star) => (\n                          <FiStar\n                            key={star}\n                            className=\"h-3.5 w-3.5\"\n                            style={{ fill: star <= review.rating ? \"#f59e0b\" : \"none\", color: star <= review.rating ? \"#f59e0b\" : \"#d1d5db\" }}\n                          />\n                        ))}\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      {/* Star Rating */}\n                      <div>\n                        <p className=\"mb-2 text-xs font-medium text-gray-500\">Your Rating</p>\n                        <div className=\"flex gap-1\">\n                          {[1, 2, 3, 4, 5].map((star) => (\n                            <button\n                              key={star}\n                              type=\"button\"\n                              onClick={() => setItemRating(productId, star)}\n                              className=\"focus:outline-none transition-transform hover:scale-110\"\n                            >\n                              <FiStar\n                                className=\"h-7 w-7 transition-colors\"\n                                style={{\n                                  fill: star <= review.rating ? \"#f59e0b\" : \"none\",\n                                  color: star <= review.rating ? \"#f59e0b\" : \"#d1d5db\",\n                                }}\n                              />\n                            </button>\n                          ))}\n                          {review.rating > 0 && (\n                            <span className=\"ml-2 self-center text-sm text-gray-500\">\n                              {[\"\", \"Poor\", \"Fair\", \"Good\", \"Very Good\", \"Excellent\"][review.rating]}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n\n                      {/* Comment */}\n                      <textarea\n                        value={review.comment}\n                        onChange={(e) => setItemComment(productId, e.target.value)}\n                        placeholder=\"Share your experience (optional)...\"\n                        rows={2}\n                        className=\"w-full resize-none rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 text-sm text-gray-700 placeholder-gray-400 focus:border-[#c47a5a] focus:bg-white focus:outline-none focus:ring-1 focus:ring-[#c47a5a]\"\n                      />\n\n                      {/* Submit Button */}\n                      <button\n                        onClick={() => submitReview(productId, item.name)}\n                        disabled={!review.rating || submittingReview === productId}\n                        className=\"flex w-full items-center justify-center gap-2 rounded-lg bg-[#c47a5a] py-2 text-sm font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-40\"\n                      >\n                        {submittingReview === productId ? (\n                          <span className=\"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n                        ) : (\n                          <FiStar className=\"h-4 w-4\" />\n                        )}\n                        {submittingReview === productId ? \"Submitting...\" : \"Submit Review\"}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// --- Sub-components ---\n\nfunction BillDetails({ bill, formatDate }: { bill: Bill; formatDate: (d: string) => string }) {\n  return (\n    <div className=\"rounded-lg bg-gray-50 p-4 space-y-2\">\n      {bill.billNumber && (\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-500\">Bill Number</span>\n          <span className=\"font-medium text-gray-700\">{bill.billNumber}</span>\n        </div>\n      )}\n      <div className=\"flex items-center justify-between text-sm\">\n        <span className=\"text-gray-500\">Amount</span>\n        <span className=\"font-semibold text-gray-800\">{formatCurrency(bill.total)}</span>\n      </div>\n      {bill.paymentMethod && (\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-500\">Payment Method</span>\n          <span className=\"font-medium capitalize text-gray-700\">{bill.paymentMethod}</span>\n        </div>\n      )}\n      <div className=\"flex items-center justify-between text-sm\">\n        <span className=\"text-gray-500\">Status</span>\n        <span className={`inline-flex items-center gap-1 text-sm font-medium ${bill.isPaid ? \"text-green-600\" : \"text-gray-500\"}`}>\n          {bill.isPaid ? <FiCheckCircle className=\"h-3.5 w-3.5\" /> : <FiXCircle className=\"h-3.5 w-3.5\" />}\n          {bill.isPaid ? \"Paid\" : \"Unpaid\"}\n        </span>\n      </div>\n      {bill.isPaid && bill.paidAt && (\n        <div className=\"flex items-center justify-between text-sm\">\n          <span className=\"text-gray-500\">Paid At</span>\n          <span className=\"font-medium text-gray-700\">{formatDate(bill.paidAt)}</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction PaymentSection({\n  selectedPayment,\n  setSelectedPayment,\n  payBill,\n  payingBill,\n}: {\n  selectedPayment: \"cash\" | \"esewa\" | \"khalti\" | \"bank\";\n  setSelectedPayment: (v: \"cash\" | \"esewa\" | \"khalti\" | \"bank\") => void;\n  payBill: () => void;\n  payingBill: boolean;\n}) {\n  const PAYMENT_METHODS = [\n    { value: \"cash\" as const, label: \"Cash\" },\n    { value: \"esewa\" as const, label: \"eSewa\" },\n    { value: \"khalti\" as const, label: \"Khalti\" },\n    { value: \"bank\" as const, label: \"Bank\" },\n  ];\n\n  return (\n    <div className=\"space-y-3 border-t border-gray-100 pt-4\">\n      <h3 className=\"text-sm font-semibold text-gray-800\">Pay Bill</h3>\n      <div className=\"grid grid-cols-4 gap-2\">\n        {PAYMENT_METHODS.map((method) => (\n          <button\n            key={method.value}\n            onClick={() => setSelectedPayment(method.value)}\n            className={`rounded-lg border px-2 py-2 text-xs font-medium transition-colors ${\n              selectedPayment === method.value\n                ? \"border-[#c47a5a] bg-[#c47a5a]/5 text-[#c47a5a]\"\n                : \"border-gray-200 text-gray-600 hover:bg-gray-50\"\n            }`}\n          >\n            {method.label}\n          </button>\n        ))}\n      </div>\n      <button\n        onClick={payBill}\n        disabled={payingBill}\n        className=\"flex w-full items-center justify-center gap-2 rounded-xl bg-[#c47a5a] px-6 py-3 font-semibold text-white transition-colors hover:bg-[#b56a4a] disabled:cursor-not-allowed disabled:opacity-50\"\n      >\n        {payingBill ? (\n          <span className=\"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent\" />\n        ) : (\n          <FiCreditCard className=\"h-5 w-5\" />\n        )}\n        {payingBill ? \"Processing...\" : \"Pay Bill\"}\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAcA;AAvBA;;;;;;;;;;AAyBA,MAAM,gBAA2E;IAC/E,SAAS;QAAE,IAAI;QAAgB,MAAM;QAAmB,KAAK;IAAgB;IAC7E,WAAW;QAAE,IAAI;QAAc,MAAM;QAAiB,KAAK;IAAc;IACzE,WAAW;QAAE,IAAI;QAAgB,MAAM;QAAmB,KAAK;IAAgB;IAC/E,QAAQ;QAAE,IAAI;QAAgB,MAAM;QAAmB,KAAK;IAAgB;IAC5E,WAAW;QAAE,IAAI;QAAe,MAAM;QAAkB,KAAK;IAAe;IAC5E,WAAW;QAAE,IAAI;QAAa,MAAM;QAAgB,KAAK;IAAa;AACxE;AAEA,MAAM,eAAe;IAAC;IAAW;IAAa;IAAa;IAAU;CAAY;AAEjF,MAAM,kBAAkB;IACtB;QAAE,OAAO;QAAQ,OAAO;IAAO;IAC/B;QAAE,OAAO;QAAS,OAAO;IAAQ;IACjC;QAAE,OAAO;QAAU,OAAO;IAAS;IACnC;QAAE,OAAO;QAAQ,OAAO;IAAgB;CACzC;AAMc,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,UAAU,OAAO,EAAE;IAEzB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAe;IACjD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAuC;IAC7F,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAc,CAAC;IACrD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAgB;IACxE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAA0B,CAAC;IAEjF,IAAA,kNAAS,EAAC;QACR,IAAI,SAAS;IACf,GAAG;QAAC;KAAQ;IAEZ,MAAM,aAAa;QACjB,WAAW;QACX,IAAI;YACF,MAAM,MAAM,MAAM,4HAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,SAAS;YAC9C,MAAM,eAAe,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,IAAI;YAC/C,SAAS;YACT,MAAM,QAAQ,GAAG,CAAC;gBAAC;gBAAa,qBAAqB;aAAc;QACrE,EAAE,OAAO,OAAY;YACnB,kKAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,WAAW;QAC/C,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,YAAY;QAChB,IAAI;YACF,MAAM,MAAM,MAAM,4HAAG,CAAC,GAAG,CAAC,CAAC,aAAa,EAAE,SAAS;YACnD,MAAM,QAAQ,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,IAAI,IAAI,EAAE;YAC9C,IAAI,MAAM,OAAO,CAAC,UAAU,MAAM,MAAM,GAAG,GAAG;gBAC5C,QAAQ,KAAK,CAAC,EAAE;YAClB,OAAO,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE;gBACxB,QAAQ,IAAI,IAAI,CAAC,IAAI;YACvB;QACF,EAAE,OAAM;QACN,qBAAqB;QACvB;IACF;IAEA,MAAM,uBAAuB,OAAO;QAClC,IAAI,aAAa,MAAM,KAAK,aAAa;QACzC,IAAI;YACF,MAAM,aAAa,aAAa,KAAK,CAAC,GAAG,CAAC,CAAC,OAAS,KAAK,OAAO;YAChE,MAAM,WAAoC,CAAC;YAC3C,MAAM,QAAQ,GAAG,CACf,WAAW,GAAG,CAAC,OAAO;gBACpB,IAAI;oBACF,MAAM,MAAM,MAAM,4HAAG,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,UAAU,UAAU,CAAC;oBACnE,gFAAgF;oBAChF,QAAQ,CAAC,UAAU,GAAG;gBACxB,EAAE,OAAM;oBACN,QAAQ,CAAC,UAAU,GAAG;gBACxB;YACF;YAEF,mBAAmB;QACrB,EAAE,OAAM;QACN,SAAS;QACX;IACF;IAEA,MAAM,yBAAyB,OAAO,UAAoC,CAAC,CAAC;QAC1E,kBAAkB;QAClB,IAAI;YACF,MAAM,MAAM,MAAM,4HAAG,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,QAAQ,QAAQ,CAAC,EAAE;gBACtD,YAAY,QAAQ,UAAU,IAAI;YACpC;YACA,QAAQ,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI;YACjC,kKAAK,CAAC,OAAO,CACX,QAAQ,UAAU,GAAG,0CAA0C;QAEnE,EAAE,OAAO,OAAY;YACnB,kKAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,WAAW;QAC/C,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,MAAM;QACX,MAAM,QAAQ,sCAAgC,0BAAgC;QAC9E,MAAM,UAAU,iEAAmC;QACnD,OAAO,IAAI,CAAC,GAAG,QAAQ,OAAO,EAAE,KAAK,GAAG,CAAC,WAAW,EAAE,OAAO,EAAE;IACjE;IAEA,MAAM,eAAe;QACnB,OAAO,KAAK;IACd;IAEA,MAAM,UAAU;QACd,IAAI,CAAC,MAAM;QACX,cAAc;QACd,IAAI;YACF,MAAM,MAAM,MAAM,4HAAG,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,KAAK,GAAG,CAAC,IAAI,CAAC,EAAE;gBAAE,eAAe;YAAgB;YACrF,QAAQ,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI;YACjC,MAAM,WAAW,MAAM,4HAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,SAAS;YACnD,SAAS,SAAS,IAAI,CAAC,KAAK,IAAI,SAAS,IAAI;YAC7C,kKAAK,CAAC,OAAO,CAAC;QAChB,EAAE,OAAO,OAAY;YACnB,kKAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,WAAW;QAC/C,SAAU;YACR,cAAc;QAChB;IACF;IAEA,MAAM,UAAU;QACd,IAAI,CAAC,OAAO;QACZ,cAAc;QACd,IAAI;YACF,MAAM,QAAQ,GAAG,CACf,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,OACf,4HAAG,CAAC,IAAI,CAAC,aAAa;oBAAE,WAAW,KAAK,OAAO;oBAAE,UAAU,KAAK,QAAQ;gBAAC;YAG7E,kKAAK,CAAC,OAAO,CAAC;YACd,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,OAAY;YACnB,kKAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,WAAW;QAC/C,SAAU;YACR,cAAc;QAChB;IACF;IAEA,MAAM,gBAAgB,CAAC,WAAmB;QACxC,WAAW,CAAC,OAAS,CAAC;gBACpB,GAAG,IAAI;gBACP,CAAC,UAAU,EAAE;oBAAE,GAAG,IAAI,CAAC,UAAU;oBAAE;oBAAQ,SAAS,IAAI,CAAC,UAAU,EAAE,WAAW;gBAAG;YACrF,CAAC;IACH;IAEA,MAAM,iBAAiB,CAAC,WAAmB;QACzC,WAAW,CAAC,OAAS,CAAC;gBACpB,GAAG,IAAI;gBACP,CAAC,UAAU,EAAE;oBAAE,GAAG,IAAI,CAAC,UAAU;oBAAE;oBAAS,QAAQ,IAAI,CAAC,UAAU,EAAE,UAAU;gBAAE;YACnF,CAAC;IACH;IAEA,MAAM,eAAe,OAAO,WAAmB;QAC7C,MAAM,SAAS,OAAO,CAAC,UAAU;QACjC,IAAI,CAAC,QAAQ,QAAQ;YACnB,kKAAK,CAAC,KAAK,CAAC;YACZ;QACF;QACA,oBAAoB;QACpB,IAAI;YACF,MAAM,4HAAG,CAAC,IAAI,CAAC,YAAY;gBACzB,SAAS;gBACT,OAAO;gBACP,QAAQ,OAAO,MAAM;gBACrB,SAAS,OAAO,OAAO;YACzB;YACA,WAAW,CAAC,OAAS,CAAC;oBACpB,GAAG,IAAI;oBACP,CAAC,UAAU,EAAE;wBAAE,GAAG,IAAI,CAAC,UAAU;wBAAE,WAAW;oBAAK;gBACrD,CAAC;YACD,kKAAK,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,SAAS,WAAW,CAAC;QACnD,EAAE,OAAO,OAAY;YACnB,kKAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,WAAW;QAC/C,SAAU;YACR,oBAAoB;QACtB;IACF;IAEA,MAAM,aAAa,CAAC,UAClB,IAAI,KAAK,SAAS,kBAAkB,CAAC,SAAS;YAC5C,KAAK;YACL,OAAO;YACP,MAAM;YACN,MAAM;YACN,QAAQ;QACV;IAEF,MAAM,gBAAgB,CAAC,MAAc;QACnC,IAAI,kBAAkB,aAAa,OAAO;QAC1C,MAAM,UAAU,aAAa,OAAO,CAAC;QACrC,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,UAAU,YAAY,OAAO;QACjC,IAAI,YAAY,YAAY,OAAO;QACnC,OAAO;IACT;IAEA,MAAM,WAAW,OAAO,WAAW;IACnC,MAAM,cAAc,OAAO,WAAW;IACtC,MAAM,cAAc,OAAO,WAAW;IAEtC,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;;;;;8BACf,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;;;;;sCACf,8OAAC;4BAAI,WAAU;;;;;;;;;;;;8BAEjB,8OAAC;oBAAI,WAAU;8BACZ,MAAM,IAAI,CAAC;wBAAE,QAAQ;oBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,8OAAC;4BAAY,WAAU;;8CACrB,8OAAC;oCAAI,WAAU;;;;;;8CACf,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;;;;;sDACf,8OAAC;4CAAI,WAAU;;;;;;;;;;;;;2BAJT;;;;;;;;;;;;;;;;IAWpB;IAEA,IAAI,CAAC,OAAO;QACV,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC,uKAAI;oBAAC,MAAK;oBAAU,WAAU;;sCAC7B,8OAAC,6JAAW;4BAAC,WAAU;;;;;;wBAAY;;;;;;;8BAErC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,2JAAS;4BAAC,WAAU;;;;;;sCACrB,8OAAC;4BAAE,WAAU;sCAAoC;;;;;;;;;;;;;;;;;;IAIzD;IAEA,MAAM,SAAS,aAAa,CAAC,MAAM,MAAM,CAAC;IAE1C,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC,uKAAI;gBAAC,MAAK;gBAAU,WAAU;;kCAC7B,8OAAC,6JAAW;wBAAC,WAAU;;;;;;oBAAY;;;;;;;0BAIrC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAG,WAAU;;wCAAkC;wCACtC,MAAM,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,WAAW;;;;;;;8CAEzC,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAK,WAAU;;8DACd,8OAAC,yJAAO;oDAAC,WAAU;;;;;;gDAClB,WAAW,MAAM,SAAS;;;;;;;wCAE5B,MAAM,WAAW,kBAChB,8OAAC;4CAAK,WAAU;;8DACd,8OAAC,2JAAS;oDAAC,WAAU;;;;;;gDAAY;gDAC1B,MAAM,WAAW;;;;;;;;;;;;;;;;;;;sCAMhC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAK,WAAW,CAAC,4EAA4E,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE,OAAO,IAAI,EAAE;;sDACxH,8OAAC;4CAAK,WAAW,CAAC,qBAAqB,EAAE,OAAO,GAAG,EAAE;;;;;;wCACpD,MAAM,MAAM,CAAC,MAAM,CAAC,GAAG,WAAW,KAAK,MAAM,MAAM,CAAC,KAAK,CAAC;;;;;;;8CAE7D,8OAAC;oCAAK,WAAW,CAAC,4EAA4E,EAAE,MAAM,MAAM,GAAG,+BAA+B,6BAA6B;;wCACxK,MAAM,MAAM,iBAAG,8OAAC,+JAAa;4CAAC,WAAU;;;;;iEAAmB,8OAAC,2JAAS;4CAAC,WAAU;;;;;;wCAChF,MAAM,MAAM,GAAG,SAAS;;;;;;;;;;;;;;;;;;;;;;;;YAOhC,CAAC,6BACA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA6C;;;;;;kCAC3D,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;gCACC,WAAU;gCACV,OAAO;oCACL,OAAO,GAAG,AAAC,aAAa,OAAO,CAAC,MAAM,MAAM,IAAI,CAAC,aAAa,MAAM,GAAG,CAAC,IAAK,IAAI,CAAC,CAAC;gCACrF;;;;;;4BAGD,aAAa,GAAG,CAAC,CAAC;gCACjB,MAAM,aAAa,cAAc,MAAM,MAAM,MAAM;gCACnD,qBACE,8OAAC;oCAAe,WAAU;;sDACxB,8OAAC;4CACC,WAAW,CAAC,8EAA8E,EACxF,eAAe,SACX,kCACA,eAAe,WACf,8BACA,4BACJ;sDAED,eAAe,uBACd,8OAAC,+JAAa;gDAAC,WAAU;;;;;qEAEzB,8OAAC;gDACC,WAAW,CAAC,yBAAyB,EACnC,eAAe,WAAW,iBAAiB,eAC3C;;;;;;;;;;;sDAIR,8OAAC;4CACC,WAAW,CAAC,+BAA+B,EACzC,eAAe,WAAW,mBAAmB,eAAe,SAAS,kBAAkB,iBACvF;sDAED;;;;;;;mCAzBK;;;;;4BA6Bd;;;;;;;;;;;;;YAML,6BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,2JAAS;wBAAC,WAAU;;;;;;kCACrB,8OAAC;wBAAE,WAAU;kCAAmC;;;;;;;;;;;;0BAKpD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;;oCAAsC;oCAAQ,MAAM,KAAK,CAAC,MAAM;oCAAC;;;;;;;0CAE/E,8OAAC;gCACC,SAAS;gCACT,UAAU;gCACV,WAAU;;oCAET,2BACC,8OAAC;wCAAK,WAAU;;;;;6DAEhB,8OAAC,gKAAc;wCAAC,WAAU;;;;;;oCAE3B,aAAa,cAAc;;;;;;;;;;;;;kCAGhC,8OAAC;wBAAI,WAAU;kCACZ,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,sBACtB,8OAAC;gCAAgB,WAAU;;kDACzB,8OAAC,wIAAK;wCACJ,KAAK,IAAA,gIAAW,EAAC,KAAK,KAAK;wCAC3B,KAAK,KAAK,IAAI;wCACd,OAAO;wCACP,QAAQ;wCACR,WAAW;wCACX,WAAU;;;;;;kDAEZ,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAE,WAAU;0DAAuC,KAAK,IAAI;;;;;;0DAC7D,8OAAC;gDAAE,WAAU;;oDACV,IAAA,wIAAc,EAAC,KAAK,KAAK;oDAAE;oDAAI,KAAK,QAAQ;;;;;;;;;;;;;kDAGjD,8OAAC;wCAAK,WAAU;kDACb,IAAA,wIAAc,EAAC,KAAK,KAAK,GAAG,KAAK,QAAQ;;;;;;;+BAhBpC;;;;;;;;;;;;;;;;YAwBf,MAAM,KAAK,kBACV,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA2C;;;;;;kCACzD,8OAAC;wBAAE,WAAU;kCAAyB,MAAM,KAAK;;;;;;;;;;;;0BAKrD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA2C;;;;;;kCACzD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAgB;;;;;;kDAChC,8OAAC;wCAAK,WAAU;kDAA6B,IAAA,wIAAc,EAAC,MAAM,QAAQ;;;;;;;;;;;;0CAE5E,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAgB;;;;;;kDAChC,8OAAC;wCAAK,WAAU;kDAA6B,IAAA,wIAAc,EAAC,MAAM,GAAG;;;;;;;;;;;;0CAEvE,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAK,WAAU;sDAAwC;;;;;;sDACxD,8OAAC;4CAAK,WAAU;sDAAmC,IAAA,wIAAc,EAAC,MAAM,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YASpF,0BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA2C;;;;;;oBAExD,CAAC,qBACA,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,SAAS,IAAM;gCACf,UAAU;gCACV,WAAU;;oCAET,+BACC,8OAAC;wCAAK,WAAU;;;;;6DAEhB,8OAAC,4JAAU;wCAAC,WAAU;;;;;;oCAEvB,iBAAiB,kBAAkB;;;;;;;0CAEtC,8OAAC;gCACC,SAAS,IAAM,uBAAuB;wCAAE,YAAY;oCAAK;gCACzD,UAAU;gCACV,WAAU;;kDAEV,8OAAC,yJAAO;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;+BAIjC,AAAC,KAAa,MAAM,KAAK,4BAC3B,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,yJAAO;wCAAC,WAAU;;;;;;kDACnB,8OAAC;wCAAK,WAAU;kDAAgC;;;;;;;;;;;;0CAElD,8OAAC;gCAAY,MAAM;gCAAM,YAAY;;;;;;0CACrC,8OAAC;gCAAO,SAAS;gCAAa,WAAU;;kDACtC,8OAAC,4JAAU;wCAAC,WAAU;;;;;;oCAAY;;;;;;;4BAEnC,CAAC,KAAK,MAAM,kBACX,8OAAC;gCACC,iBAAiB;gCACjB,oBAAoB;gCACpB,SAAS;gCACT,YAAY;;;;;;;;;;;6CAKlB,8OAAC;wBAAI,WAAU;;4BACZ,KAAK,MAAM,kBACV,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,+JAAa;wCAAC,WAAU;;;;;;kDACzB,8OAAC;wCAAK,WAAU;kDAA+B;;;;;;oCAC9C,KAAK,aAAa,kBACjB,8OAAC;wCAAK,WAAU;;4CAAyB;0DAAI,8OAAC;gDAAK,WAAU;0DAAc,KAAK,aAAa;;;;;;;;;;;;;;;;;;0CAInG,8OAAC;gCAAY,MAAM;gCAAM,YAAY;;;;;;0CACrC,8OAAC;gCAAO,SAAS;gCAAa,WAAU;;kDACtC,8OAAC,4JAAU;wCAAC,WAAU;;;;;;oCAAY;;;;;;;4BAEnC,CAAC,KAAK,MAAM,kBACX,8OAAC;gCACC,iBAAiB;gCACjB,oBAAoB;gCACpB,SAAS;gCACT,YAAY;;;;;;;;;;;;;;;;;;YASvB,6BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAAsC;;;;;;4BACnD,sBACC,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,SAAS;wCACT,WAAU;;0DAEV,8OAAC,4JAAU;gDAAC,WAAU;;;;;;4CAAY;;;;;;;kDAEpC,8OAAC;wCACC,SAAS;wCACT,WAAU;;0DAEV,8OAAC,2JAAS;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;;;;;;;;kCAOzC,8OAAC;wBAAI,WAAU;;0CAEb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAE,WAAU;kDAAkC;;;;;;kDAC/C,8OAAC;wCAAE,WAAU;kDAAwB;;;;;;kDACrC,8OAAC;wCAAE,WAAU;;4CAA6B;4CAAQ,MAAM,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,WAAW;;;;;;;kDACjF,8OAAC;wCAAE,WAAU;kDAAyB,WAAW,MAAM,SAAS;;;;;;oCAC/D,MAAM,WAAW,kBAAI,8OAAC;wCAAE,WAAU;;4CAAwB;4CAAO,MAAM,WAAW;;;;;;;;;;;;;0CAIrF,8OAAC;gCAAI,WAAU;0CACZ,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,oBACtB,8OAAC;wCAAc,WAAU;;0DACvB,8OAAC;gDAAK,WAAU;;oDACb,KAAK,IAAI;oDAAC;kEAAC,8OAAC;wDAAK,WAAU;;4DAAgB;4DAAE,KAAK,QAAQ;;;;;;;;;;;;;0DAE7D,8OAAC;gDAAK,WAAU;0DAA6B,IAAA,wIAAc,EAAC,KAAK,KAAK,GAAG,KAAK,QAAQ;;;;;;;uCAJ9E;;;;;;;;;;0CAUd,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;0DAAgB;;;;;;0DAChC,8OAAC;gDAAK,WAAU;0DAAe,IAAA,wIAAc,EAAC,MAAM,QAAQ;;;;;;;;;;;;kDAE9D,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;0DAAgB;;;;;;0DAChC,8OAAC;gDAAK,WAAU;0DAAe,IAAA,wIAAc,EAAC,MAAM,GAAG;;;;;;;;;;;;kDAEzD,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;0DAAK;;;;;;0DACN,8OAAC;0DAAM,IAAA,wIAAc,EAAC,MAAM,KAAK;;;;;;;;;;;;;;;;;;4BAKpC,sBACC,8OAAC;gCAAI,WAAU;;oCACZ,KAAK,UAAU,kBACd,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DAAe,KAAK,UAAU;;;;;;;;;;;;oCAGjD,KAAK,aAAa,kBACjB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DAA0B,KAAK,aAAa;;;;;;;;;;;;kDAGhE,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;0DAAgB;;;;;;0DAChC,8OAAC;gDAAK,WAAW,CAAC,cAAc,EAAE,KAAK,MAAM,GAAG,mBAAmB,gBAAgB;0DAChF,KAAK,MAAM,GAAG,SAAS;;;;;;;;;;;;oCAG3B,KAAK,MAAM,IAAI,KAAK,MAAM,kBACzB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;0DAAK;;;;;;0DACN,8OAAC;gDAAK,WAAU;0DAAe,WAAW,KAAK,MAAM;;;;;;;;;;;;;;;;;;4BAO5D,CAAC,sBACA,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAE,WAAU;8CAA0B;;;;;;;;;;;4BAK1C,QAAQ,CAAC,KAAK,MAAM,kBACnB,8OAAC;gCACC,iBAAiB;gCACjB,oBAAoB;gCACpB,SAAS;gCACT,YAAY;;;;;;;;;;;;;;;;;;YAQrB,6BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,yJAAO;gCAAC,WAAU;;;;;;0CACnB,8OAAC;gCAAG,WAAU;0CAAsC;;;;;;;;;;;;kCAGtD,8OAAC;wBAAI,WAAU;kCACZ,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM;4BACtB,MAAM,YAAY,KAAK,OAAO;4BAC9B,MAAM,SAAS,OAAO,CAAC,UAAU,IAAI;gCAAE,QAAQ;gCAAG,SAAS;gCAAI,WAAW;4BAAM;4BAEhF,qBACE,8OAAC;gCAAc,WAAU;;kDACvB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,wIAAK;gDACJ,KAAK,IAAA,gIAAW,EAAC,KAAK,KAAK;gDAC3B,KAAK,KAAK,IAAI;gDACd,OAAO;gDACP,QAAQ;gDACR,WAAW;gDACX,WAAU;;;;;;0DAEZ,8OAAC;;kEACC,8OAAC;wDAAE,WAAU;kEAAuC,KAAK,IAAI;;;;;;kEAC7D,8OAAC;wDAAE,WAAU;kEAAyB,IAAA,wIAAc,EAAC,KAAK,KAAK;;;;;;;;;;;;;;;;;;oCAIlE,OAAO,SAAS,iBACf,8OAAC;wCAAI,WAAU;;0DACb,8OAAC,+JAAa;gDAAC,WAAU;;;;;;0DACzB,8OAAC;gDAAK,WAAU;0DAAqC;;;;;;0DACrD,8OAAC;gDAAI,WAAU;0DACZ;oDAAC;oDAAG;oDAAG;oDAAG;oDAAG;iDAAE,CAAC,GAAG,CAAC,CAAC,qBACpB,8OAAC,wJAAM;wDAEL,WAAU;wDACV,OAAO;4DAAE,MAAM,QAAQ,OAAO,MAAM,GAAG,YAAY;4DAAQ,OAAO,QAAQ,OAAO,MAAM,GAAG,YAAY;wDAAU;uDAF3G;;;;;;;;;;;;;;;6DAQb,8OAAC;wCAAI,WAAU;;0DAEb,8OAAC;;kEACC,8OAAC;wDAAE,WAAU;kEAAyC;;;;;;kEACtD,8OAAC;wDAAI,WAAU;;4DACZ;gEAAC;gEAAG;gEAAG;gEAAG;gEAAG;6DAAE,CAAC,GAAG,CAAC,CAAC,qBACpB,8OAAC;oEAEC,MAAK;oEACL,SAAS,IAAM,cAAc,WAAW;oEACxC,WAAU;8EAEV,cAAA,8OAAC,wJAAM;wEACL,WAAU;wEACV,OAAO;4EACL,MAAM,QAAQ,OAAO,MAAM,GAAG,YAAY;4EAC1C,OAAO,QAAQ,OAAO,MAAM,GAAG,YAAY;wEAC7C;;;;;;mEAVG;;;;;4DAcR,OAAO,MAAM,GAAG,mBACf,8OAAC;gEAAK,WAAU;0EACb;oEAAC;oEAAI;oEAAQ;oEAAQ;oEAAQ;oEAAa;iEAAY,CAAC,OAAO,MAAM,CAAC;;;;;;;;;;;;;;;;;;0DAO9E,8OAAC;gDACC,OAAO,OAAO,OAAO;gDACrB,UAAU,CAAC,IAAM,eAAe,WAAW,EAAE,MAAM,CAAC,KAAK;gDACzD,aAAY;gDACZ,MAAM;gDACN,WAAU;;;;;;0DAIZ,8OAAC;gDACC,SAAS,IAAM,aAAa,WAAW,KAAK,IAAI;gDAChD,UAAU,CAAC,OAAO,MAAM,IAAI,qBAAqB;gDACjD,WAAU;;oDAET,qBAAqB,0BACpB,8OAAC;wDAAK,WAAU;;;;;6EAEhB,8OAAC,wJAAM;wDAAC,WAAU;;;;;;oDAEnB,qBAAqB,YAAY,kBAAkB;;;;;;;;;;;;;;+BAhFlD;;;;;wBAsFd;;;;;;;;;;;;;;;;;;AAMZ;AAEA,yBAAyB;AAEzB,SAAS,YAAY,EAAE,IAAI,EAAE,UAAU,EAAqD;IAC1F,qBACE,8OAAC;QAAI,WAAU;;YACZ,KAAK,UAAU,kBACd,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAgB;;;;;;kCAChC,8OAAC;wBAAK,WAAU;kCAA6B,KAAK,UAAU;;;;;;;;;;;;0BAGhE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAgB;;;;;;kCAChC,8OAAC;wBAAK,WAAU;kCAA+B,IAAA,wIAAc,EAAC,KAAK,KAAK;;;;;;;;;;;;YAEzE,KAAK,aAAa,kBACjB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAgB;;;;;;kCAChC,8OAAC;wBAAK,WAAU;kCAAwC,KAAK,aAAa;;;;;;;;;;;;0BAG9E,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAgB;;;;;;kCAChC,8OAAC;wBAAK,WAAW,CAAC,mDAAmD,EAAE,KAAK,MAAM,GAAG,mBAAmB,iBAAiB;;4BACtH,KAAK,MAAM,iBAAG,8OAAC,+JAAa;gCAAC,WAAU;;;;;qDAAmB,8OAAC,2JAAS;gCAAC,WAAU;;;;;;4BAC/E,KAAK,MAAM,GAAG,SAAS;;;;;;;;;;;;;YAG3B,KAAK,MAAM,IAAI,KAAK,MAAM,kBACzB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAgB;;;;;;kCAChC,8OAAC;wBAAK,WAAU;kCAA6B,WAAW,KAAK,MAAM;;;;;;;;;;;;;;;;;;AAK7E;AAEA,SAAS,eAAe,EACtB,eAAe,EACf,kBAAkB,EAClB,OAAO,EACP,UAAU,EAMX;IACC,MAAM,kBAAkB;QACtB;YAAE,OAAO;YAAiB,OAAO;QAAO;QACxC;YAAE,OAAO;YAAkB,OAAO;QAAQ;QAC1C;YAAE,OAAO;YAAmB,OAAO;QAAS;QAC5C;YAAE,OAAO;YAAiB,OAAO;QAAO;KACzC;IAED,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAsC;;;;;;0BACpD,8OAAC;gBAAI,WAAU;0BACZ,gBAAgB,GAAG,CAAC,CAAC,uBACpB,8OAAC;wBAEC,SAAS,IAAM,mBAAmB,OAAO,KAAK;wBAC9C,WAAW,CAAC,kEAAkE,EAC5E,oBAAoB,OAAO,KAAK,GAC5B,mDACA,kDACJ;kCAED,OAAO,KAAK;uBARR,OAAO,KAAK;;;;;;;;;;0BAYvB,8OAAC;gBACC,SAAS;gBACT,UAAU;gBACV,WAAU;;oBAET,2BACC,8OAAC;wBAAK,WAAU;;;;;6CAEhB,8OAAC,8JAAY;wBAAC,WAAU;;;;;;oBAEzB,aAAa,kBAAkB;;;;;;;;;;;;;AAIxC"}}]
}